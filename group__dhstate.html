<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Noise-C: DHState API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Noise-C
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">DHState API</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gacd53cb04a20ac2ee334693c4b4248956"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structNoiseDHState__s.html">NoiseDHState_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a></td></tr>
<tr class="memdesc:gacd53cb04a20ac2ee334693c4b4248956"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque object that represents a DHState.  <a href="#gacd53cb04a20ac2ee334693c4b4248956">More...</a><br/></td></tr>
<tr class="separator:gacd53cb04a20ac2ee334693c4b4248956"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga72076f5192308be0e095470d7b7a1891"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga72076f5192308be0e095470d7b7a1891">noise_dhstate_calculate</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *private_key_state, const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *public_key_state, uint8_t *shared_key, size_t shared_key_len)</td></tr>
<tr class="memdesc:ga72076f5192308be0e095470d7b7a1891"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a Diffie-Hellman calculation.  <a href="#ga72076f5192308be0e095470d7b7a1891">More...</a><br/></td></tr>
<tr class="separator:ga72076f5192308be0e095470d7b7a1891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8166b90a31317f33c940fc82aa7b2ce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gac8166b90a31317f33c940fc82aa7b2ce">noise_dhstate_clear_key</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:gac8166b90a31317f33c940fc82aa7b2ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the key in a DHState object.  <a href="#gac8166b90a31317f33c940fc82aa7b2ce">More...</a><br/></td></tr>
<tr class="separator:gac8166b90a31317f33c940fc82aa7b2ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a950deb50cd6ca5c25ef2b6404ddf48"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga5a950deb50cd6ca5c25ef2b6404ddf48">noise_dhstate_copy</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state, const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *from)</td></tr>
<tr class="memdesc:ga5a950deb50cd6ca5c25ef2b6404ddf48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the keys from one DHState object to another.  <a href="#ga5a950deb50cd6ca5c25ef2b6404ddf48">More...</a><br/></td></tr>
<tr class="separator:ga5a950deb50cd6ca5c25ef2b6404ddf48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ced2bdae2849e0062f8723556c4da69"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga3ced2bdae2849e0062f8723556c4da69">noise_dhstate_format_fingerprint</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state, int fingerprint_type, char *buffer, size_t len)</td></tr>
<tr class="memdesc:ga3ced2bdae2849e0062f8723556c4da69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Formats the public key fingerprint for the key within a DHState.  <a href="#ga3ced2bdae2849e0062f8723556c4da69">More...</a><br/></td></tr>
<tr class="separator:ga3ced2bdae2849e0062f8723556c4da69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga05b705a292e82c508ab8a337c4f8aea3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga05b705a292e82c508ab8a337c4f8aea3">noise_dhstate_free</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:ga05b705a292e82c508ab8a337c4f8aea3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a DHState object after destroying all sensitive material.  <a href="#ga05b705a292e82c508ab8a337c4f8aea3">More...</a><br/></td></tr>
<tr class="separator:ga05b705a292e82c508ab8a337c4f8aea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga921137066457bfc4b273ad5a03a0415f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga921137066457bfc4b273ad5a03a0415f">noise_dhstate_generate_dependent_keypair</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state, const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *other)</td></tr>
<tr class="memdesc:ga921137066457bfc4b273ad5a03a0415f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a new key pair within a DHState object that may depend upon the parameters from another DHState object.  <a href="#ga921137066457bfc4b273ad5a03a0415f">More...</a><br/></td></tr>
<tr class="separator:ga921137066457bfc4b273ad5a03a0415f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e8cf5645611200af11977fefb12b290"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga4e8cf5645611200af11977fefb12b290">noise_dhstate_generate_keypair</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:ga4e8cf5645611200af11977fefb12b290"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a new key pair within a DHState object.  <a href="#ga4e8cf5645611200af11977fefb12b290">More...</a><br/></td></tr>
<tr class="separator:ga4e8cf5645611200af11977fefb12b290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad190aa76c6100a1ce18dc066f764474a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gad190aa76c6100a1ce18dc066f764474a">noise_dhstate_get_dh_id</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:gad190aa76c6100a1ce18dc066f764474a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the algorithm identifier for a DHState object.  <a href="#gad190aa76c6100a1ce18dc066f764474a">More...</a><br/></td></tr>
<tr class="separator:gad190aa76c6100a1ce18dc066f764474a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacfb68c245cadc7f4c420ccb6ec9a08f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gacfb68c245cadc7f4c420ccb6ec9a08f5">noise_dhstate_get_keypair</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state, uint8_t *private_key, size_t private_key_len, uint8_t *public_key, size_t public_key_len)</td></tr>
<tr class="memdesc:gacfb68c245cadc7f4c420ccb6ec9a08f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the keypair from within a DHState object.  <a href="#gacfb68c245cadc7f4c420ccb6ec9a08f5">More...</a><br/></td></tr>
<tr class="separator:gacfb68c245cadc7f4c420ccb6ec9a08f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada42ef950369824e089cd6fbb32b1438"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gada42ef950369824e089cd6fbb32b1438">noise_dhstate_get_private_key_length</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:gada42ef950369824e089cd6fbb32b1438"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the length of the private key for a DHState object.  <a href="#gada42ef950369824e089cd6fbb32b1438">More...</a><br/></td></tr>
<tr class="separator:gada42ef950369824e089cd6fbb32b1438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3f309448ef895b037fdf8a6b812fe40"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gaf3f309448ef895b037fdf8a6b812fe40">noise_dhstate_get_public_key</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state, uint8_t *public_key, size_t public_key_len)</td></tr>
<tr class="memdesc:gaf3f309448ef895b037fdf8a6b812fe40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the public key value from a DHState object.  <a href="#gaf3f309448ef895b037fdf8a6b812fe40">More...</a><br/></td></tr>
<tr class="separator:gaf3f309448ef895b037fdf8a6b812fe40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga37e9dfeeeadce4f90339cf1ffe5b1e2f"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga37e9dfeeeadce4f90339cf1ffe5b1e2f">noise_dhstate_get_public_key_length</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:ga37e9dfeeeadce4f90339cf1ffe5b1e2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the length of the public key for a DHState object.  <a href="#ga37e9dfeeeadce4f90339cf1ffe5b1e2f">More...</a><br/></td></tr>
<tr class="separator:ga37e9dfeeeadce4f90339cf1ffe5b1e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3d245b5d1866d489566e99ccbea662f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga3d245b5d1866d489566e99ccbea662f3">noise_dhstate_get_role</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:ga3d245b5d1866d489566e99ccbea662f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the role that a DHState object will play in a handshake.  <a href="#ga3d245b5d1866d489566e99ccbea662f3">More...</a><br/></td></tr>
<tr class="separator:ga3d245b5d1866d489566e99ccbea662f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0ee1c268584933d007fdac16e95c3ec"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gae0ee1c268584933d007fdac16e95c3ec">noise_dhstate_get_shared_key_length</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:gae0ee1c268584933d007fdac16e95c3ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the length of the shared key for a DHState object.  <a href="#gae0ee1c268584933d007fdac16e95c3ec">More...</a><br/></td></tr>
<tr class="separator:gae0ee1c268584933d007fdac16e95c3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad70dda4e2945deae1b9d1aa0f157c8dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gad70dda4e2945deae1b9d1aa0f157c8dc">noise_dhstate_has_keypair</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:gad70dda4e2945deae1b9d1aa0f157c8dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if a DHState object contains a keypair.  <a href="#gad70dda4e2945deae1b9d1aa0f157c8dc">More...</a><br/></td></tr>
<tr class="separator:gad70dda4e2945deae1b9d1aa0f157c8dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1af6ca1345a21c2f674d87382be7b0d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga1af6ca1345a21c2f674d87382be7b0d6">noise_dhstate_has_public_key</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:ga1af6ca1345a21c2f674d87382be7b0d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if a DHState object contains a public key.  <a href="#ga1af6ca1345a21c2f674d87382be7b0d6">More...</a><br/></td></tr>
<tr class="separator:ga1af6ca1345a21c2f674d87382be7b0d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9712e4649d0d65234ae24560274c7490"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga9712e4649d0d65234ae24560274c7490">noise_dhstate_is_ephemeral_only</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:ga9712e4649d0d65234ae24560274c7490"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if a DHState object only supports ephemeral keys.  <a href="#ga9712e4649d0d65234ae24560274c7490">More...</a><br/></td></tr>
<tr class="separator:ga9712e4649d0d65234ae24560274c7490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa263022048cf6fe3279c90c479715e67"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gaa263022048cf6fe3279c90c479715e67">noise_dhstate_is_null_public_key</a> (const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:gaa263022048cf6fe3279c90c479715e67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the public key in a DHState object has the special null value.  <a href="#gaa263022048cf6fe3279c90c479715e67">More...</a><br/></td></tr>
<tr class="separator:gaa263022048cf6fe3279c90c479715e67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga92ae8d4e63fee46fcdbd5e5931eb3551"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga92ae8d4e63fee46fcdbd5e5931eb3551">noise_dhstate_new_by_id</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> **state, int id)</td></tr>
<tr class="memdesc:ga92ae8d4e63fee46fcdbd5e5931eb3551"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new DHState object by its algorithm identifier.  <a href="#ga92ae8d4e63fee46fcdbd5e5931eb3551">More...</a><br/></td></tr>
<tr class="separator:ga92ae8d4e63fee46fcdbd5e5931eb3551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga345b2bc6c6641cdddd93fafa42a5d440"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga345b2bc6c6641cdddd93fafa42a5d440">noise_dhstate_new_by_name</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> **state, const char *name)</td></tr>
<tr class="memdesc:ga345b2bc6c6641cdddd93fafa42a5d440"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new DHState object by its algorithm name.  <a href="#ga345b2bc6c6641cdddd93fafa42a5d440">More...</a><br/></td></tr>
<tr class="separator:ga345b2bc6c6641cdddd93fafa42a5d440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaba2d5df7a3e727e479a297c231383dcc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gaba2d5df7a3e727e479a297c231383dcc">noise_dhstate_set_keypair</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state, const uint8_t *private_key, size_t private_key_len, const uint8_t *public_key, size_t public_key_len)</td></tr>
<tr class="memdesc:gaba2d5df7a3e727e479a297c231383dcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the keypair within a DHState object.  <a href="#gaba2d5df7a3e727e479a297c231383dcc">More...</a><br/></td></tr>
<tr class="separator:gaba2d5df7a3e727e479a297c231383dcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa0bcd74dfbbd47c7e54fa413e437093f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gaa0bcd74dfbbd47c7e54fa413e437093f">noise_dhstate_set_keypair_private</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state, const uint8_t *private_key, size_t private_key_len)</td></tr>
<tr class="memdesc:gaa0bcd74dfbbd47c7e54fa413e437093f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the keypair within a DHState object based on a private key only.  <a href="#gaa0bcd74dfbbd47c7e54fa413e437093f">More...</a><br/></td></tr>
<tr class="separator:gaa0bcd74dfbbd47c7e54fa413e437093f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga615959000774dcf6484152d439b72f59"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#ga615959000774dcf6484152d439b72f59">noise_dhstate_set_null_public_key</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state)</td></tr>
<tr class="memdesc:ga615959000774dcf6484152d439b72f59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the public key in a DHState object to the special null value.  <a href="#ga615959000774dcf6484152d439b72f59">More...</a><br/></td></tr>
<tr class="separator:ga615959000774dcf6484152d439b72f59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6fa00b45a6db3bb405ed1163e09ae95"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gac6fa00b45a6db3bb405ed1163e09ae95">noise_dhstate_set_public_key</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state, const uint8_t *public_key, size_t public_key_len)</td></tr>
<tr class="memdesc:gac6fa00b45a6db3bb405ed1163e09ae95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the public key in a DHState object.  <a href="#gac6fa00b45a6db3bb405ed1163e09ae95">More...</a><br/></td></tr>
<tr class="separator:gac6fa00b45a6db3bb405ed1163e09ae95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab448054707a261d51fb1ef65c1d49810"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dhstate.html#gab448054707a261d51fb1ef65c1d49810">noise_dhstate_set_role</a> (<a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *state, int role)</td></tr>
<tr class="memdesc:gab448054707a261d51fb1ef65c1d49810"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the role that a DHState object will play in a handshake.  <a href="#gab448054707a261d51fb1ef65c1d49810">More...</a><br/></td></tr>
<tr class="separator:gab448054707a261d51fb1ef65c1d49810"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>DHState objects are used to store the keypairs for the local party or the public keys for remote parties. Once the keys have been set, <a class="el" href="group__dhstate.html#ga72076f5192308be0e095470d7b7a1891" title="Performs a Diffie-Hellman calculation. ">noise_dhstate_calculate()</a> can be used to perform a Diffie-Hellman operation with two DHState objects. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gacd53cb04a20ac2ee334693c4b4248956"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opaque object that represents a DHState. </p>

<p>Definition at line <a class="el" href="dhstate_8h_source.html#l00033">33</a> of file <a class="el" href="dhstate_8h_source.html">dhstate.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga72076f5192308be0e095470d7b7a1891"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_calculate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>private_key_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>public_key_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>shared_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>shared_key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a Diffie-Hellman calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">private_key_state</td><td>Points to the DHState containing the private key. </td></tr>
    <tr><td class="paramname">public_key_state</td><td>Points to the DHState containing the public key. </td></tr>
    <tr><td class="paramname">shared_key</td><td>Points to the shared key on exit. </td></tr>
    <tr><td class="paramname">shared_key_len</td><td>The length of the <em>shared_key</em> buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>private_key_state</em>, <em>public_key_state</em>, or <em>shared_key</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>private_key_state</em> and <em>public_key_state</em> do not have the same algorithm identifier. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>shared_key_len</em> is not correct for the algorithm. </dd>
<dd>
NOISE_ERROR_INVALID_PRIVATE_KEY if <em>private_key_state</em> does not contain a private key or the private key is invalid. </dd>
<dd>
NOISE_ERROR_INVALID_PUBLIC_KEY if the public key in <em>public_key_state</em> is invalid.</dd></dl>
<p>If the input public key is the special null value, then the output <em>shared_key</em> will also be the null value and NOISE_ERROR_NONE will be returned.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga4e8cf5645611200af11977fefb12b290" title="Generates a new key pair within a DHState object. ">noise_dhstate_generate_keypair()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00686">686</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gac8166b90a31317f33c940fc82aa7b2ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_clear_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears the key in a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gad70dda4e2945deae1b9d1aa0f157c8dc" title="Determine if a DHState object contains a keypair. ">noise_dhstate_has_keypair()</a>, <a class="el" href="group__dhstate.html#ga1af6ca1345a21c2f674d87382be7b0d6" title="Determine if a DHState object contains a public key. ">noise_dhstate_has_public_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00622">622</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga5a950deb50cd6ca5c25ef2b6404ddf48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_copy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies the keys from one DHState object to another. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState to copy into. </td></tr>
    <tr><td class="paramname">from</td><td>The DHState to copy from.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>from</em> is NULL. </dd>
<dd>
NOISE_ERROR_NOT_APPLICABLE if <em>from</em> does not have the same key type identifier as <em>state</em>. </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00730">730</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga3ced2bdae2849e0062f8723556c4da69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_format_fingerprint </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fingerprint_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Formats the public key fingerprint for the key within a DHState. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object. </td></tr>
    <tr><td class="paramname">fingerprint_type</td><td>The type of fingerprint to format, NOISE_FINGERPRINT_BASIC or NOISE_FINGERPRINT_FULL. </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer to write the fingerprint string to, including a terminating NUL. </td></tr>
    <tr><td class="paramname">len</td><td>The length of <em>buffer</em> in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>buffer</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>fingerprint_type</em> is not a supported fingerprint type. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>len</em> is not large enough to hold the entire fingerprint string. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if a public key has not been set on <em>state</em> yet.</dd></dl>
<p>Fingerprints are created by hashing the public key with SHA256 and then formatting the value in hexadecimal with bytes separated by colons. If the <em>fingerprint_type</em> is NOISE_FINGERPRINT_BASIC, then the SHA256 hash value is truncated to the first 16 bytes. If the type is NOISE_FINGERPRINT_FULL, then the entire 32 byte hash value is formatted. </p>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00776">776</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga05b705a292e82c508ab8a337c4f8aea3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a DHState object after destroying all sensitive material. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object to free.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga92ae8d4e63fee46fcdbd5e5931eb3551" title="Creates a new DHState object by its algorithm identifier. ">noise_dhstate_new_by_id()</a>, <a class="el" href="group__dhstate.html#ga345b2bc6c6641cdddd93fafa42a5d440" title="Creates a new DHState object by its algorithm name. ">noise_dhstate_new_by_name()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00146">146</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga921137066457bfc4b273ad5a03a0415f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_generate_dependent_keypair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>other</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a new key pair within a DHState object that may depend upon the parameters from another DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object. </td></tr>
    <tr><td class="paramname">other</td><td>The other DHState object to obtain parameters from, which may be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> and <em>other</em> do not have the same algorithm identifier. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if dependent parameters are required but <em>other</em> does not currently contain any.</dd></dl>
<p>This function is intended for generating ephemeral keypairs for algorithms like New Hope where the keypair for Bob depends upon parameters that are transmitted in Alice's public key. If the algorithm does not require dependent parameters to generate the keypair, <em>other</em> is ignored.</p>
<dl class="section note"><dt>Note</dt><dd>This function needs to generate random key material for the private key, so the system random number generator must be properly seeded before calling this function.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga72076f5192308be0e095470d7b7a1891" title="Performs a Diffie-Hellman calculation. ">noise_dhstate_calculate()</a>, <a class="el" href="group__dhstate.html#gaba2d5df7a3e727e479a297c231383dcc" title="Sets the keypair within a DHState object. ">noise_dhstate_set_keypair()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00332">332</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga4e8cf5645611200af11977fefb12b290"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_generate_keypair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a new key pair within a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function needs to generate random key material for the private key, so the system random number generator must be properly seeded before calling this function.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga72076f5192308be0e095470d7b7a1891" title="Performs a Diffie-Hellman calculation. ">noise_dhstate_calculate()</a>, <a class="el" href="group__dhstate.html#gaba2d5df7a3e727e479a297c231383dcc" title="Sets the keypair within a DHState object. ">noise_dhstate_set_keypair()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00289">289</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gad190aa76c6100a1ce18dc066f764474a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_get_dh_id </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the algorithm identifier for a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The algorithm identifier, or NOISE_DH_NONE if <em>state</em> is NULL. </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00168">168</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gacfb68c245cadc7f4c420ccb6ec9a08f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_get_keypair </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>private_key_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>public_key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the keypair from within a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object. </td></tr>
    <tr><td class="paramname">private_key</td><td>Points to the buffer to receive the private key. </td></tr>
    <tr><td class="paramname">private_key_len</td><td>The private key buffer length in bytes. </td></tr>
    <tr><td class="paramname">public_key</td><td>Points to the buffer to receive the public key. </td></tr>
    <tr><td class="paramname">public_key_len</td><td>The public key buffer length in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em>, <em>private_key</em>, or <em>public_key</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if either <em>private_key_len</em> or <em>public_key_len</em> is incorrect for the algorithm. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if <em>state</em> does not contain a keypair.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gaba2d5df7a3e727e479a297c231383dcc" title="Sets the keypair within a DHState object. ">noise_dhstate_set_keypair()</a>, <a class="el" href="group__dhstate.html#gaf3f309448ef895b037fdf8a6b812fe40" title="Gets the public key value from a DHState object. ">noise_dhstate_get_public_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00462">462</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gada42ef950369824e089cd6fbb32b1438"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t noise_dhstate_get_private_key_length </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the length of the private key for a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the private key in bytes, or 0 if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga37e9dfeeeadce4f90339cf1ffe5b1e2f" title="Gets the length of the public key for a DHState object. ">noise_dhstate_get_public_key_length()</a>, <a class="el" href="group__dhstate.html#gae0ee1c268584933d007fdac16e95c3ec" title="Gets the length of the shared key for a DHState object. ">noise_dhstate_get_shared_key_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00198">198</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaf3f309448ef895b037fdf8a6b812fe40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_get_public_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>public_key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the public key value from a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object. </td></tr>
    <tr><td class="paramname">public_key</td><td>The buffer to receive the public key value. </td></tr>
    <tr><td class="paramname">public_key_len</td><td>The public key length in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>public_key</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>public_key_len</em> is incorrect for this algorithm.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gac6fa00b45a6db3bb405ed1163e09ae95" title="Sets the public key in a DHState object. ">noise_dhstate_set_public_key()</a>, <a class="el" href="group__dhstate.html#ga37e9dfeeeadce4f90339cf1ffe5b1e2f" title="Gets the length of the public key for a DHState object. ">noise_dhstate_get_public_key_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00551">551</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga37e9dfeeeadce4f90339cf1ffe5b1e2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t noise_dhstate_get_public_key_length </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the length of the public key for a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the public key in bytes, or 0 if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gada42ef950369824e089cd6fbb32b1438" title="Gets the length of the private key for a DHState object. ">noise_dhstate_get_private_key_length()</a>, <a class="el" href="group__dhstate.html#gae0ee1c268584933d007fdac16e95c3ec" title="Gets the length of the shared key for a DHState object. ">noise_dhstate_get_shared_key_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00183">183</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga3d245b5d1866d489566e99ccbea662f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_get_role </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the role that a DHState object will play in a handshake. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The role, NOISE_ROLE_INITIATOR or NOISE_ROLE_RESPONDER, or zero if the role has not been set yet.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gab448054707a261d51fb1ef65c1d49810" title="Sets the role that a DHState object will play in a handshake. ">noise_dhstate_set_role()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00805">805</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gae0ee1c268584933d007fdac16e95c3ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t noise_dhstate_get_shared_key_length </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the length of the shared key for a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the shared key in bytes, or 0 if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga37e9dfeeeadce4f90339cf1ffe5b1e2f" title="Gets the length of the public key for a DHState object. ">noise_dhstate_get_public_key_length()</a>, <a class="el" href="group__dhstate.html#gada42ef950369824e089cd6fbb32b1438" title="Gets the length of the private key for a DHState object. ">noise_dhstate_get_private_key_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00213">213</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gad70dda4e2945deae1b9d1aa0f157c8dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_has_keypair </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if a DHState object contains a keypair. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 if <em>state</em> contains both a private key and a public key. Returns 0 if <em>state</em> is NULL or it only contains a public key.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gaba2d5df7a3e727e479a297c231383dcc" title="Sets the keypair within a DHState object. ">noise_dhstate_set_keypair()</a>, <a class="el" href="group__dhstate.html#ga1af6ca1345a21c2f674d87382be7b0d6" title="Determine if a DHState object contains a public key. ">noise_dhstate_has_public_key()</a>, <a class="el" href="group__dhstate.html#gac8166b90a31317f33c940fc82aa7b2ce" title="Clears the key in a DHState object. ">noise_dhstate_clear_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00247">247</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga1af6ca1345a21c2f674d87382be7b0d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_has_public_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if a DHState object contains a public key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 if <em>state</em> contains a public key (and optionally a private key). Returns 0 if <em>state</em> is NULL or it does not contain a public key.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gaba2d5df7a3e727e479a297c231383dcc" title="Sets the keypair within a DHState object. ">noise_dhstate_set_keypair()</a>, <a class="el" href="group__dhstate.html#ga1af6ca1345a21c2f674d87382be7b0d6" title="Determine if a DHState object contains a public key. ">noise_dhstate_has_public_key()</a>, <a class="el" href="group__dhstate.html#gac8166b90a31317f33c940fc82aa7b2ce" title="Clears the key in a DHState object. ">noise_dhstate_clear_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00267">267</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga9712e4649d0d65234ae24560274c7490"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_is_ephemeral_only </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if a DHState object only supports ephemeral keys. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if the DHState object only supports ephemeral keys, or zero if the DHState object supports both static and ephemeral keys.</dd></dl>
<p>Some algorithms like "NewHope" can only be used to generate ephemeral keys during a session and have no support for long-term static keys. </p>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00230">230</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaa263022048cf6fe3279c90c479715e67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_is_null_public_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the public key in a DHState object has the special null value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns non-zero if the public key within <em>state</em> is the special null value; zero otherwise.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga615959000774dcf6484152d439b72f59" title="Sets the public key in a DHState object to the special null value. ">noise_dhstate_set_null_public_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00602">602</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga92ae8d4e63fee46fcdbd5e5931eb3551"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_new_by_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> **&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new DHState object by its algorithm identifier. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Points to the variable where to store the pointer to the new DHState object. </td></tr>
    <tr><td class="paramname">id</td><td>The algorithm identifier; NOISE_DH_CURVE25519, NOISE_DH_CURVE448, etc.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL. </dd>
<dd>
NOISE_ERROR_UNKNOWN_ID if <em>id</em> is unknown. </dd>
<dd>
NOISE_ERROR_NO_MEMORY if there is insufficient memory to allocate the new DHState object.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga05b705a292e82c508ab8a337c4f8aea3" title="Frees a DHState object after destroying all sensitive material. ">noise_dhstate_free()</a>, <a class="el" href="group__dhstate.html#ga345b2bc6c6641cdddd93fafa42a5d440" title="Creates a new DHState object by its algorithm name. ">noise_dhstate_new_by_name()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00067">67</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga345b2bc6c6641cdddd93fafa42a5d440"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_new_by_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> **&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new DHState object by its algorithm name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Points to the variable where to store the pointer to the new DHState object. </td></tr>
    <tr><td class="paramname">name</td><td>The name of the Diffie-Hellman algorithm; e.g. "25519". This string must be NUL-terminated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>name</em> is NULL. </dd>
<dd>
NOISE_ERROR_UNKNOWN_NAME if <em>name</em> is unknown. </dd>
<dd>
NOISE_ERROR_NO_MEMORY if there is insufficient memory to allocate the new DHState object.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga05b705a292e82c508ab8a337c4f8aea3" title="Frees a DHState object after destroying all sensitive material. ">noise_dhstate_free()</a>, <a class="el" href="group__dhstate.html#ga92ae8d4e63fee46fcdbd5e5931eb3551" title="Creates a new DHState object by its algorithm identifier. ">noise_dhstate_new_by_id()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00116">116</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaba2d5df7a3e727e479a297c231383dcc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_set_keypair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>private_key_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>public_key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the keypair within a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object. </td></tr>
    <tr><td class="paramname">private_key</td><td>Points to the private key. </td></tr>
    <tr><td class="paramname">private_key_len</td><td>The private key length in bytes. </td></tr>
    <tr><td class="paramname">public_key</td><td>Points to the public key. </td></tr>
    <tr><td class="paramname">public_key_len</td><td>The public key length in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em>, <em>private_key</em>, or <em>public_key</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if either <em>private_key_len</em> or <em>public_key_len</em> is incorrect for the algorithm. </dd>
<dd>
NOISE_ERROR_INVALID_PRIVATE_KEY if <em>private_key</em> is not valid. </dd>
<dd>
NOISE_ERROR_INVALID_PUBLIC_KEY if <em>public_key</em> is not valid.</dd></dl>
<p>The algorithm may decide to defer NOISE_ERROR_INVALID_PRIVATE_KEY or NOISE_ERROR_INVALID_PUBLIC_KEY to later when the keypair is actually used during <a class="el" href="group__dhstate.html#ga72076f5192308be0e095470d7b7a1891" title="Performs a Diffie-Hellman calculation. ">noise_dhstate_calculate()</a>.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gacfb68c245cadc7f4c420ccb6ec9a08f5" title="Gets the keypair from within a DHState object. ">noise_dhstate_get_keypair()</a>, <a class="el" href="group__dhstate.html#gac6fa00b45a6db3bb405ed1163e09ae95" title="Sets the public key in a DHState object. ">noise_dhstate_set_public_key()</a>, <a class="el" href="group__dhstate.html#gaa0bcd74dfbbd47c7e54fa413e437093f" title="Sets the keypair within a DHState object based on a private key only. ">noise_dhstate_set_keypair_private()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00374">374</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaa0bcd74dfbbd47c7e54fa413e437093f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_set_keypair_private </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>private_key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the keypair within a DHState object based on a private key only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object. </td></tr>
    <tr><td class="paramname">private_key</td><td>Points to the private key. </td></tr>
    <tr><td class="paramname">private_key_len</td><td>The private key length in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>private_key</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if either <em>private_key_len</em> is incorrect for the algorithm. </dd>
<dd>
NOISE_ERROR_INVALID_PRIVATE_KEY if <em>private_key</em> is not valid. </dd>
<dd>
NOISE_ERROR_INVALID_PUBLIC_KEY if <em>public_key</em> that is derived from the <em>private_key</em> is not valid.</dd></dl>
<p>The algorithm may decide to defer NOISE_ERROR_INVALID_PRIVATE_KEY or NOISE_ERROR_INVALID_PUBLIC_KEY to later when the keypair is actually used during <a class="el" href="group__dhstate.html#ga72076f5192308be0e095470d7b7a1891" title="Performs a Diffie-Hellman calculation. ">noise_dhstate_calculate()</a>.</p>
<p>This function only takes the private key as an argument. The public key in the keypair is derived from the private key.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gacfb68c245cadc7f4c420ccb6ec9a08f5" title="Gets the keypair from within a DHState object. ">noise_dhstate_get_keypair()</a>, <a class="el" href="group__dhstate.html#gac6fa00b45a6db3bb405ed1163e09ae95" title="Sets the public key in a DHState object. ">noise_dhstate_set_public_key()</a>, <a class="el" href="group__dhstate.html#gaba2d5df7a3e727e479a297c231383dcc" title="Sets the keypair within a DHState object. ">noise_dhstate_set_keypair()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00423">423</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga615959000774dcf6484152d439b72f59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_set_null_public_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the public key in a DHState object to the special null value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> does not support null public keys.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gaa263022048cf6fe3279c90c479715e67" title="Determine if the public key in a DHState object has the special null value. ">noise_dhstate_is_null_public_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00576">576</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gac6fa00b45a6db3bb405ed1163e09ae95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_set_public_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>public_key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the public key in a DHState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object. </td></tr>
    <tr><td class="paramname">public_key</td><td>Points to the public key. </td></tr>
    <tr><td class="paramname">public_key_len</td><td>The public key length in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>public_key</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>public_key_len</em> is incorrect for the algorithm. </dd>
<dd>
NOISE_ERROR_INVALID_PUBLIC_KEY if <em>public_key</em> is not valid and it is not the special null value.</dd></dl>
<p>After this function succeeds, the DHState will only contain a public key. Any existing private key will be cleared. Thus, this function is useful to set the public key of a remote party. Use <a class="el" href="group__dhstate.html#gaba2d5df7a3e727e479a297c231383dcc" title="Sets the keypair within a DHState object. ">noise_dhstate_set_keypair()</a> to set both the public and private key for the local party.</p>
<p>The algorithm may decide to defer NOISE_ERROR_INVALID_PUBLIC_KEY to later when the public key is actually used during <a class="el" href="group__dhstate.html#ga72076f5192308be0e095470d7b7a1891" title="Performs a Diffie-Hellman calculation. ">noise_dhstate_calculate()</a>.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#gaf3f309448ef895b037fdf8a6b812fe40" title="Gets the public key value from a DHState object. ">noise_dhstate_get_public_key()</a>, <a class="el" href="group__dhstate.html#gaba2d5df7a3e727e479a297c231383dcc" title="Sets the keypair within a DHState object. ">noise_dhstate_set_keypair()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00511">511</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gab448054707a261d51fb1ef65c1d49810"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_dhstate_set_role </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__dhstate.html#gacd53cb04a20ac2ee334693c4b4248956">NoiseDHState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>role</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the role that a DHState object will play in a handshake. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The DHState object. </td></tr>
    <tr><td class="paramname">role</td><td>The role, NOISE_ROLE_INITIATOR or NOISE_ROLE_RESPONDER, or zero if the role is unspecified.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>role</em> is not one of NOISE_ROLE_INITIATOR, NOISE_ROLE_RESPONDER, or zero.</dd></dl>
<p>This function is intended for use with algorithms that have a different method for calculating public keys and shared secrets for the two parties in a communication. An example is the post-quantum SIDH algorithm where "Alice" and "Bob" differ in the calculations they perform.</p>
<p>To assist with supporting such algorithms, the HandshakeState labels DHState objects as either initiator or responder depending upon who owns that specific key. The algorithm-specific back end can then use the role information to determine which object it wants to treat as "Alice" and which object should be treated as "Bob".</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__dhstate.html#ga3d245b5d1866d489566e99ccbea662f3" title="Gets the role that a DHState object will play in a handshake. ">noise_dhstate_get_role()</a> </dd></dl>

<p>Definition at line <a class="el" href="dhstate_8c_source.html#l00835">835</a> of file <a class="el" href="dhstate_8c_source.html">dhstate.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Oct 19 2016 20:30:20 for Noise-C by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
