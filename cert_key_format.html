<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Noise-C: Certificate and private key format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Noise-C
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Certificate and private key format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#cert_design">Design principles</a></li>
<li class="level1"><a href="#cert_format">Certificate format</a><ul><li class="level2"><a href="#cert_overall_format">Overall format of a certificate</a></li>
<li class="level2"><a href="#cert_subject">Subject information</a></li>
<li class="level2"><a href="#cert_signature">Signature blocks</a></li>
<li class="level2"><a href="#cert_other">Other issues</a></li>
</ul>
</li>
<li class="level1"><a href="#key_format">Private key format</a></li>
<li class="level1"><a href="#fingerprints">Public key fingerprints</a></li>
</ul>
</div>
<div class="textblock"><p>This document describes certificate and private key formats that are proposed for use in implementations of Noise.</p>
<h1><a class="anchor" id="cert_design"></a>
Design principles</h1>
<p>The following principles were considered when designing this format:</p>
<ul>
<li>It should be a simple text-based format that can be viewed with ordinary text viewers and manipulated with oridinary text tools. </li>
<li>Compact representation so that certificates chains of reasonable length can fit within a single Noise packet. </li>
<li>Editing a certificate to add new signature blocks should be easy. </li>
<li>Certificate chains are the simple concatenation of multiple certificates. </li>
<li>No surprises. A human signer can read and understand the text format and decide whether they are willing to sign the certificate. Binary formats make it difficult to know what you are actually signing.</li>
</ul>
<h1><a class="anchor" id="cert_format"></a>
Certificate format</h1>
<p>The following is an example of a minimal certificate for "Jane Smith" that has been signed by "Trent Peoples":</p>
<div class="fragment"><div class="line">-NOISE-CERT-V1-</div>
<div class="line">Name: Jane Smith</div>
<div class="line">Id: jane.smith@example.com</div>
<div class="line">Enc-Role: client</div>
<div class="line">Enc-Key: 25519,0bvYYwOPwdtcrove1ij37SbAhnuQ++4j2+/sELJaNUA=</div>
<div class="line">-SIGNATURE-</div>
<div class="line">Name: Trent Peoples</div>
<div class="line">Id: tpeoples@example.org</div>
<div class="line">Sign-Key: Ed25519,dS45RT8DNVhldxcHgsFHj6NA6pKs5dF2lUrda9lhoAb=</div>
<div class="line">Nonce: Lya4LdMCDhAwVbJf8oKwFw==</div>
<div class="line">Valid-From: 2016-03-15T00:00:00Z</div>
<div class="line">Valid-To: 2026-03-15T23:59:59Z</div>
<div class="line">Signature: BLAKE2b,28pgTWIJGGXIL5CJ4zSQoM9jLWQtzdTpqQ2wLFr1esmtdMakMJdDyQw3pkI1poyftCFEuAnJa7v8VAhpOzE+zg==</div>
<div class="line">-END-NOISE-CERT-</div>
</div><!-- fragment --><p>Here, Jane has declared that her Curve25519 encryption key will be used in the "client" role. Trent then accepted that role, hashed the certificate data with "BLAKE2b", and added his signature using the "Ed25519" algorithm.</p>
<p>The signature covers all lines from <code>-NOISE-CERT-V1-</code> through to the line just before <code>-Signature-</code>. Line endings MUST be normalized to CRLF's when computing the signature.</p>
<p>Multiple signature blocks can be included from multiple signers:</p>
<div class="fragment"><div class="line">-NOISE-CERT-V1-</div>
<div class="line">Name: Jane Smith</div>
<div class="line">Id: jane.smith@example.com</div>
<div class="line">Enc-Role: client</div>
<div class="line">Enc-Key: 25519,0bvYYwOPwdtcrove1ij37SbAhnuQ++4j2+/sELJaNUA=</div>
<div class="line">Enc-Key: 448,fPgovvcg4ZEHZdAOnUP89KV39u87pDZtVqdLBWZWhCzy9DPWc76PmtgZZpn3EpXqiw4zJCadA6Y=</div>
<div class="line">-SIGNATURE-</div>
<div class="line">Name: Trent Peoples</div>
<div class="line">Id: tpeoples@example.org</div>
<div class="line">Sign-Key: Ed25519,dS45RT8DNVhldxcHgsFHj6NA6pKs5dF2lUrda9lhoAb=</div>
<div class="line">Nonce: Lya4LdMCDhAwVbJf8oKwFw==</div>
<div class="line">Valid-From: 2016-03-15T00:00:00Z</div>
<div class="line">Valid-To: 2026-03-15T23:59:59Z</div>
<div class="line">Signature: BLAKE2b,28pgTWIJGGXIL5CJ4zSQoM9jLWQtzdTpqQ2wLFr1esmtdMakMJdDyQw3pkI1poyftCFEuAnJa7v8VAhpOzE+zg==</div>
<div class="line">-SIGNATURE-</div>
<div class="line">Name: Mary Sue</div>
<div class="line">Id: mary.sue@example.com</div>
<div class="line">Sign-Key: Ed25519,GMzi9DASQiLw0t1sAvgCSwjddHEQs9Xkaq3x3g0iQin=</div>
<div class="line">Nonce: z/doQzK8LEwAovegMZzDcw==</div>
<div class="line">Valid-From: 2015-05-17T00:00:00Z</div>
<div class="line">Valid-To: 2025-05-17T23:59:59Z</div>
<div class="line">Signature: SHA512,JBUjGRz8KCLh1HnqWjZ9ayj/Fzc2WJcoZSu9o9aWZ8VX0X5Q1ETQ+SpJH1UwQRq90fcMv6T6zXbNj16qwQu1eg==</div>
<div class="line">-END-NOISE-CERT-</div>
</div><!-- fragment --><p>Each signature is independent, covering the subject information leading up to the first <code>-SIGNATURE-</code> line, and then continuing with the details for the specific signer. In the above example, Mary's signature does not include the details from Trent. The certificate would be equally valid with Mary's signature listed first.</p>
<p>Because the signatures are independent, new signatures can be added to the end of the certificate at any time. Or old signatures can be removed from the certificate at any time. Any remaining signatures will remain valid as they only vouch for Jane's identity, not the identity of the other signers.</p>
<p>This approach also allows certificates to be trimmed when they are sent in Noise packets. If the client is communicating with a server that trusts Trent as a certificate authority, then there is no need to send the signature block for Mary. Certificates may also be trimmed to hide the identity of additional signers from remote parties that do not need to know about those signers.</p>
<dl class="section note"><dt>Note</dt><dd>Signatures provide additional information that may help bind a key to an identity for specific use cases, but signatures are not necessary for secure communication to occur. Protocols should keep this in mind when using Noise certificates. The lack of a signature does not imply that the user is untrustworthy. It only implies that the user has not found anyone yet who they trust to sign their certificate. Other strategies such as "Trust On First Use" can be used to manage certificates that lack signatures.</dd></dl>
<h2><a class="anchor" id="cert_overall_format"></a>
Overall format of a certificate</h2>
<p>Certificiates are represented in UTF-8, and consist of lines of UTF-8 text. Lines SHOULD be terminated with CRLF, and MAY be terminated with a single LF. LF line terminators MUST be converted into CRLF before hashing the data to sign it. There MUST NOT be any extra whitespace on the start or end of lines.</p>
<p>Certificates MUST start with a line <code>-NOISE-CERT-V1-</code>, called the "certificate introducer". Certificates MUST end with a line <code>-END-NOISE-CERT-</code>, called the "certificate terminator".</p>
<p>The certificate introducer is followed by the "subject information" fields. Each field consists of a name, followed by a colon and a space character, and then followed by the field's value.</p>
<p>Field names are a sequence of printable US-ASCII characters chosen from the set A-Z, a-z, 0-9, and the minus sign. The field name MUST NOT start with a minus sign. Any other character before the colon other than those from the recommended set is considered an error. Field names starting with "X-" are reserved for private use.</p>
<p>The field name SHOULD be made up of English words or abbreviations that are clear as to their meaning in the context of the larger protocol. The restriction to English words and abbreviations is motivated by the "No surprises" design principle. A human reading the field name should have no problem determining what the field is for, or finding an English speaker to explain what it is for. Non-English words or opaque abbreviations make this more difficult.</p>
<p>Field values MUST be encoded in a single line of UTF-8 text, leading up to the terminating CRLF or LF sequence. There is no support for line continuations. Lines may be of arbitrary length. When a field value is displayed to a human user, it may be necessary to wrap strings to fit in the available screen space, and to filter out unprintable control characters. Such details are left up to the implementation.</p>
<p>After the subject information, there may appear zero or more "signature blocks", each of which begins with the line <code>-SIGNATURE-</code>. The signature blocks are also a list of fields, formatted in the same way as the subject information. However, the set of allowable fields is different for signature blocks.</p>
<h2><a class="anchor" id="cert_subject"></a>
Subject information</h2>
<p>This section lists the fields that MAY appear in a Subject information block. All fields are optional.</p>
<p><code>Name</code> - The name of the subject for the certificate. This string is intended to be human-readable and MUST be encoded in UTF-8. If the <code>Name</code> is not present, <code>Id</code> can be displayed to the human user instead.</p>
<p><code>Id</code> - The identity of the subject, formatted as "foo@domain". The <code>Id</code> may look like an e-mail address but it doesn't have to be. It only needs to be unique in the context of the larger Noise protocol.</p>
<p>Both <code>Name</code> and <code>Id</code> are OPTIONAL. If neither are present, then the subject is identified by their public key fingerprint. This option is provided to protect the identity of anonymous users. A pseudonym could be used instead, but pseudonym use is not required.</p>
<p><code>Enc-Key</code> - Specifies an encryption key for the subject. The field consists of an algoritm name, a comma, and the base64 encoding of the public key value. The format of the public key value is determined from the algorithm name. The currently defined algorithms are "25519" and "448", corresponding to the Diffie-Hellman algorithms in Noise of the same names.</p>
<p><code>Enc-Role</code> - Specifies the role that the key in the next line can be used for. The currently defined values are "client" and "server", in lower case. If the same key can be used for both roles, then it must appear twice in the certificate:</p>
<div class="fragment"><div class="line">Enc-Role: client</div>
<div class="line">Enc-Key: 25519,0bvYYwOPwdtcrove1ij37SbAhnuQ++4j2+/sELJaNUA=</div>
<div class="line">Enc-Role: server</div>
<div class="line">Enc-Key: 25519,0bvYYwOPwdtcrove1ij37SbAhnuQ++4j2+/sELJaNUA=</div>
</div><!-- fragment --><p>Using the same key for multiple roles is not recommended.</p>
<p>There may be multiple <code>Enc-Key</code> lines, one for each public encryption key that the subject owns for a role. The first <code>Enc-Key</code> line SHOULD be preceded by a <code>Enc-Role</code> line defining the role. The default role is "client".</p>
<div class="fragment"><div class="line">Enc-Role: client</div>
<div class="line">Enc-Key: 25519,0bvYYwOPwdtcrove1ij37SbAhnuQ++4j2+/sELJaNUA=</div>
<div class="line">Enc-Key: 448,fPgovvcg4ZEHZdAOnUP89KV39u87pDZtVqdLBWZWhCzy9DPWc76PmtgZZpn3EpXqiw4zJCadA6Y=</div>
</div><!-- fragment --><p><code>Sign-Key</code> - Specifies a signing key for the subject. The field consists of an algorithm name, a comma, and the base64 encoding of the public key value. The format of the public key value is determined from the algorithm name. The only currently defined algorithm is "Ed25519".</p>
<p><code>Sign-Role</code> - Specifies the role that the signing key in the next line can be used for. The currently defined values are "certificate" and "identity", in lower case. A role of "certificate" indicates that the key can be used to sign certificates for other users. A role of "identity" indicates that the key is used to assert the identity of the user. If the same key can be used for both roles, then it should appear twice in the same way as <code>Enc-Role</code>. Using the same key for multiple roles is not recommended.</p>
<p>There may be multiple <code>Sign-Key</code> lines, one for each public encryption key that the subject owns for a role. The first <code>Sign-Key</code> line SHOULD be preceded by a <code>Sign-Role</code> line defining the role. The default role is "certificate".</p>
<p>While it would be possible to offer a comma-separated list of roles for a key, it was chosen not to do this. Certificate parsers can be simpler if they are checking for entire literal strings, compared with having to parse comma-separated fields. And since implementations SHOULD use different keys for different roles, different key blocks will probably be needed anyway.</p>
<p>There may be other fields in the subject information block. Any field that is not understood should be ignored by implementations. However, when a certificate is signed, these fields SHOULD be shown to the signer so that they are not tricked into signing information they do not agree with.</p>
<p>Field names that do not start with "X-" are reserved for future versions of this specification. Field names starting with "X-" may be assigned any local meaning by implementers. For example "X-Foo-Nickname" may be useful in a secure chat client called "Foo" to set the user's preferred nickname. Any information that could identify the user (such as a nickname) SHOULD be optional.</p>
<h2><a class="anchor" id="cert_signature"></a>
Signature blocks</h2>
<p>This section lists the fields that MAY appear in a Subject information block.</p>
<p><code>Name</code> and <code>Id</code> have the same format and meaning as for subject information blocks. In this case they identify the signer. Both fields can be omitted to hide the identity of the signer.</p>
<p>There SHOULD be a single <code>Sign-Key</code> line which specifies the algorithm name and public key that was used to sign the certificate. This line can be omitted if the recipient has some other means to obtain the key for the signer.</p>
<p><code>Nonce</code> is an extra pseudorandom value added by the signer, which ensures that multiple signatures for the same subject from the same signer will be different. The value should be considered opaque. It is recommended that it consist of at least 128 bits of pseudorandom data, encoded in base64. This field SHOULD be included. It MAY be omitted for anonymous users to avoid the watermarking problems described under <a class="el" href="cert_key_format.html#cert_other">Other issues</a> below. The <code>Valid-From</code> field SHOULD be included in this case to provide a fallback nonce that is different between signatures.</p>
<p><code>Valid-From</code> and <code>Valid-To</code> are OPTIONAL fields that indicate the starting and ending times for the validity of the signature. Note: This is the validity of the signature, not of the certificate. The signer is not saying "this key is valid for this period" but rather "I do not vouch for this certificate outside this time period". The subject information may remain valid for much longer. The format MUST comply with <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> as profiled in <a href="https://tools.ietf.org/html/rfc3339">RFC 3339</a>.</p>
<p><code>Signature</code> MUST be the last line in the signature block, and consists of a hash algorithm name and the actual signature produced with the <code>Sign-Key</code>.</p>
<p>The signature is computed over the following lines:</p>
<ul>
<li>The line <code>-NOISE-CERT-V1-</code>, which binds the signature to the specific certificate version. </li>
<li>All lines in the subject information block in the order in which they appear. </li>
<li>The line <code>-SIGNATURE-</code>, which separates the subject information fields from the signature information fields. </li>
<li>All lines in the signature block, excluding the final <code>Signature</code> line. </li>
<li>The line <code>-END-NOISE-CERT-</code>, which terminates the certificate.</li>
</ul>
<p>If there were any existing <code>-SIGNATURE-</code> blocks in the certificate to be signed, they are ignored when calculating the hash.</p>
<p>Lines that end in LF MUST be converted into lines ending in CRLF before applying the hash algorithm.</p>
<p>The new signature block is inserted at the end of the certificate, starting with <code>-SIGNATURE-</code> and ending just before the existing <code>-END-NOISE-CERT-</code> line.</p>
<h2><a class="anchor" id="cert_other"></a>
Other issues</h2>
<p>Any strings that are read from a certificate and presented to a human user should be preprocessed to remove or transform control characters or other data that may be problematic for the output device.</p>
<p>The <code>Nonce</code> value and implementation-specific fields could be used to watermark users who otherwise wish to remain anonymous. Once a certificate is signed, the subject will need to import the signature into their key ring. At this point the subject can see if any extra fields were inserted that concern them and reject the signature.</p>
<p>The <code>Nonce</code> field is opaque and non-obvious but highly recommended to deal with duplicate signatures for the same subject key. The <code>Nonce</code> field MAY be omitted by a signer from certificates if they wish to provide some assurance to anonymous users that they have not watermarked the signature. The <code>Valid-From</code> field is used as a fallback nonce for this case.</p>
<p>Anonymous users can choose to reject signatures that include a <code>Nonce</code>. They should also carefully inspect the <code>Valid-From</code> and <code>Valid-To</code> timestamps. Odd date or time values might provide another opportunity to include watermarking bits.</p>
<p>The main protection against this is disclosure. If it was discovered that well-known signing authorities were watermarking certificates, affected users can remove the offending signatures and seek new signers.</p>
<p>Signers may require some kind of proof that the subject is in possession of the relevant key before adding a signature. For encryption keys, the Noise protocol itself provides handshake patterns that can prove key possession.</p>
<p>A hypothetical certificate issuing protocol should check that the static public key for the session matches that in the supplied certificate. This does become more complex if the subject has multiple encryption keys or signing keys. Multiple requests may be necessary to prove ownership of the additional keys.</p>
<h1><a class="anchor" id="key_format"></a>
Private key format</h1>
<p>The private key format is similar to the certificate format, with additional information about the key:</p>
<div class="fragment"><div class="line">Name: Jane Smith</div>
<div class="line">Id: jane.smith@example.com</div>
<div class="line">Enc-Role: client</div>
<div class="line">Enc-Private-Key: 25519,0bvYYwOPwdtcrove1ij37SbAhnuQ++4j2+/sELJaNUA=</div>
<div class="line">Enc-Private-Key: 448,fPgovvcg4ZEHZdAOnUP89KV39u87pDZtVqdLBWZWhCzy9DPWc76PmtgZZpn3EpXqiw4zJCadA6Y=</div>
</div><!-- fragment --><p>The <code>Enc-Private-Key</code> field is similar to <code>Enc-Key</code> except that contains the private key component of the keypair. The public key is derived from the private key at runtime. The counterpart for signing keys is <code>Sign-Private-Key</code>.</p>
<p>The above example specifies the bare private key details. This information is not stored or transmitted in plaintext. Instead it is encrypted using a passphrase to generate data such as the following:</p>
<div class="fragment"><div class="line">-NOISE-KEY-V1-</div>
<div class="line">Algorithm: ChaChaPoly_BLAKE2b_PBKDF2</div>
<div class="line">Salt: wo3KZvAoFdR9ek5oljNAJw==</div>
<div class="line">Iterations: 30000</div>
<div class="line">-KEY-DATA-</div>
<div class="line">TmFtZTogSmFuZSBTbWl0aApJZDogamFuZS5zbWl0aEBleGFtcGxlLmNvbQpFbmMtUm9sZTogY2xp</div>
<div class="line">ZW50CkVuYy1Qcml2LUtleTogMjU1MTksMGJ2WVl3T1B3ZHRjcm92ZTFpajM3U2JBaG51USsrNGoy</div>
<div class="line">Ly9zRUxKYU5VQT0sZzZGNmpmM2o2VFB1NmM4QU51THhQZVpwOW9BdW9WaXNVR2pNV3V4a2crRT0K</div>
<div class="line">RW5jLVByaXYtS2V5OiA0NDgsZlBnb3Z2Y2c0WkVIWmRBT25VUDg5S1YzOXU4N3BEWnRWcWRMQlda</div>
<div class="line">V2hDenk5RFBXYzc2UG10Z1pacG4zRXBYcWl3NHpKQ2FkQTZZPSxvK2dyYXJrVW9LaDZmQUtCeC9R</div>
<div class="line">RUY0QTVvM3pBSmlrVFV6bkQ3M0pyMXhGWWgvVCs4T3JGNE5wVExtQkxXbk5rMjFTVXlWSCtyRmc9</div>
<div class="line">Cg==</div>
<div class="line">-END-NOISE-KEY-</div>
</div><!-- fragment --><p>Here, PBKDF2 (from <a href="https://www.ietf.org/rfc/rfc2898.txt">RFC 2898</a>) with the specified hash algorithm (BLAKE2b in this case) is used to generate an encryption key and nonce for ChaChaPoly. The first 32 bytes of the PBKDF2 output are used as the encryption key. The next 8 bytes of the PBKDF2 output are interpreted as a big-endian 64-bit value and used as the nonce. The entirety of the private key details are encrypted in a single request, which limits the size to 65535 bytes including the MAC.</p>
<p>The <code>-KEY-DATA-</code> section is the base64 encoding of the outout of encrypting the bare private key details given earlier with ChaChaPoly. The final 16 bytes of the base64-encoded data is the MAC value which can be used to verify that the correct passphrase was supplied.</p>
<p>The <code>Salt</code> and <code>Iterations</code> fields specify arguments to the PBKDF2 function. The salt SHOULD be at least 16 bytes in length, and MAY be longer at the implementation's discretion. The unsigned 32-bit iteration count should be large enough to make dictionary attacks on the private key file time-consuming on current hardware.</p>
<p>Encrypted private keys can be a hassle for servers and other systems that run unattended. Such systems may need to use a static passphrase, even if only the empty passphrase.</p>
<h1><a class="anchor" id="fingerprints"></a>
Public key fingerprints</h1>
<p>When displaying a public key to a human user, the public key SHOULD be hashed with SHA256 with first 16 bytes of the value formatted in hexadecimal, separated by colons. For example:</p>
<div class="fragment"><div class="line">34:da:01:7b:07:e1:a0:0d:64:14:be:e9:af:cf:db:7b</div>
</div><!-- fragment --><p>Fingerprints MAY be calculated with other hash algorithms or MAY include more than 16 bytes. However, SHA256 with truncation is RECOMMENDED to improve interoperability of fingerprints between implementations. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 20 2016 21:01:52 for Noise-C by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
