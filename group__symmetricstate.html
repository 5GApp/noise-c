<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Noise-C: SymmetricState API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Noise-C
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SymmetricState API</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaafb7dab7644f6ebb68fbd3a9c7b1c32c"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="internal_8h.html#structNoiseSymmetricState__s">NoiseSymmetricState_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a></td></tr>
<tr class="memdesc:gaafb7dab7644f6ebb68fbd3a9c7b1c32c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque object that represents a SymmetricState.  <a href="#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">More...</a><br/></td></tr>
<tr class="separator:gaafb7dab7644f6ebb68fbd3a9c7b1c32c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga278bd4948592b1c5609df3657bd61b07"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#ga278bd4948592b1c5609df3657bd61b07">noise_symmetricstate_decrypt_and_hash</a> (<a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *state, <a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *buffer)</td></tr>
<tr class="memdesc:ga278bd4948592b1c5609df3657bd61b07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a block of data with this SymmetricState object and adds the ciphertext to the handshake hash.  <a href="#ga278bd4948592b1c5609df3657bd61b07">More...</a><br/></td></tr>
<tr class="separator:ga278bd4948592b1c5609df3657bd61b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb445fe2e3796abb8aabaf198ed5fd8b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#gafb445fe2e3796abb8aabaf198ed5fd8b">noise_symmetricstate_encrypt_and_hash</a> (<a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *state, <a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *buffer)</td></tr>
<tr class="memdesc:gafb445fe2e3796abb8aabaf198ed5fd8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts a block of data with this SymmetricState object and adds the ciphertext to the handshake hash.  <a href="#gafb445fe2e3796abb8aabaf198ed5fd8b">More...</a><br/></td></tr>
<tr class="separator:gafb445fe2e3796abb8aabaf198ed5fd8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6577c4265dd0cd484de5485a4b829cb9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#ga6577c4265dd0cd484de5485a4b829cb9">noise_symmetricstate_free</a> (<a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *state)</td></tr>
<tr class="memdesc:ga6577c4265dd0cd484de5485a4b829cb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a SymmetricState object after destroying all sensitive material.  <a href="#ga6577c4265dd0cd484de5485a4b829cb9">More...</a><br/></td></tr>
<tr class="separator:ga6577c4265dd0cd484de5485a4b829cb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c6c8d15eb40a3de6b2a5f8457bee820"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#ga7c6c8d15eb40a3de6b2a5f8457bee820">noise_symmetricstate_get_mac_length</a> (const <a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *state)</td></tr>
<tr class="memdesc:ga7c6c8d15eb40a3de6b2a5f8457bee820"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current length of packet MAC values for a SymmetricState object.  <a href="#ga7c6c8d15eb40a3de6b2a5f8457bee820">More...</a><br/></td></tr>
<tr class="separator:ga7c6c8d15eb40a3de6b2a5f8457bee820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e8ec56dd66b6fe9f04cf9ff1f144b79"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#ga9e8ec56dd66b6fe9f04cf9ff1f144b79">noise_symmetricstate_get_protocol_id</a> (const <a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *state, <a class="el" href="group__names.html#structNoiseProtocolId">NoiseProtocolId</a> *id)</td></tr>
<tr class="memdesc:ga9e8ec56dd66b6fe9f04cf9ff1f144b79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the protocol identifier associated with a SymmetricState object.  <a href="#ga9e8ec56dd66b6fe9f04cf9ff1f144b79">More...</a><br/></td></tr>
<tr class="separator:ga9e8ec56dd66b6fe9f04cf9ff1f144b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga88c5f5a80bc4984eff45cacdce01d11c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#ga88c5f5a80bc4984eff45cacdce01d11c">noise_symmetricstate_mix_hash</a> (<a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *state, const uint8_t *input, size_t size)</td></tr>
<tr class="memdesc:ga88c5f5a80bc4984eff45cacdce01d11c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mixes new input data into the handshake hash.  <a href="#ga88c5f5a80bc4984eff45cacdce01d11c">More...</a><br/></td></tr>
<tr class="separator:ga88c5f5a80bc4984eff45cacdce01d11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac792150120af1e5f6f45ebb42023b35a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#gac792150120af1e5f6f45ebb42023b35a">noise_symmetricstate_mix_key</a> (<a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *state, const uint8_t *input, size_t size)</td></tr>
<tr class="memdesc:gac792150120af1e5f6f45ebb42023b35a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mixes new input data into the chaining key.  <a href="#gac792150120af1e5f6f45ebb42023b35a">More...</a><br/></td></tr>
<tr class="separator:gac792150120af1e5f6f45ebb42023b35a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8198aa2fea89f65139360558ee622aed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#ga8198aa2fea89f65139360558ee622aed">noise_symmetricstate_new_by_id</a> (<a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> **state, const <a class="el" href="group__names.html#structNoiseProtocolId">NoiseProtocolId</a> *id)</td></tr>
<tr class="memdesc:ga8198aa2fea89f65139360558ee622aed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new SymmetricState object from a protocol identifier.  <a href="#ga8198aa2fea89f65139360558ee622aed">More...</a><br/></td></tr>
<tr class="separator:ga8198aa2fea89f65139360558ee622aed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga29d5f792aa9dc3cbff5609ff0bbce543"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#ga29d5f792aa9dc3cbff5609ff0bbce543">noise_symmetricstate_new_by_name</a> (<a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> **state, const char *name)</td></tr>
<tr class="memdesc:ga29d5f792aa9dc3cbff5609ff0bbce543"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new SymmetricState object from a protocol name.  <a href="#ga29d5f792aa9dc3cbff5609ff0bbce543">More...</a><br/></td></tr>
<tr class="separator:ga29d5f792aa9dc3cbff5609ff0bbce543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadcb03d5b22400016e003a8d62d0790e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__symmetricstate.html#gadcb03d5b22400016e003a8d62d0790e1">noise_symmetricstate_split</a> (<a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *state, <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **c1, <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **c2, const uint8_t *secondary_key, size_t secondary_key_len)</td></tr>
<tr class="memdesc:gadcb03d5b22400016e003a8d62d0790e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Splits the transport encryption CipherState objects out of this SymmetricState object.  <a href="#gadcb03d5b22400016e003a8d62d0790e1">More...</a><br/></td></tr>
<tr class="separator:gadcb03d5b22400016e003a8d62d0790e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gaafb7dab7644f6ebb68fbd3a9c7b1c32c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opaque object that represents a SymmetricState. </p>

<p>Definition at line <a class="el" href="symmetricstate_8h_source.html#l00033">33</a> of file <a class="el" href="symmetricstate_8h_source.html">symmetricstate.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga278bd4948592b1c5609df3657bd61b07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_symmetricstate_decrypt_and_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a block of data with this SymmetricState object and adds the ciphertext to the handshake hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The SymmetricState object. </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer containing the ciphertext plus MAC on entry and the plaintext on exit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>buffer</em> is NULL. </dd>
<dd>
NOISE_ERROR_MAC_FAILURE if the MAC check failed. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if this SymmetricState has already been split. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if the nonce previously overflowed. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if the data in <em>buffer</em> is larger than 65535 bytes or too small to contain the MAC value.</dd></dl>
<p>The ciphertext is decrypted in-place with the plaintext also written to <em>buffer</em>. In other words, it is assumed that the ciphertext plus MAC is in an input buffer ready to be processed once the MAC has been checked and the ciphertext has been decrypted.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__symmetricstate.html#gafb445fe2e3796abb8aabaf198ed5fd8b" title="Encrypts a block of data with this SymmetricState object and adds the ciphertext to the handshake has...">noise_symmetricstate_encrypt_and_hash()</a> </dd></dl>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00403">403</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gafb445fe2e3796abb8aabaf198ed5fd8b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_symmetricstate_encrypt_and_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts a block of data with this SymmetricState object and adds the ciphertext to the handshake hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The SymmetricState object. </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer containing the plaintext on entry and the ciphertext plus MAC on exit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>buffer</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if the nonce previously overflowed </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if the ciphertext plus MAC is too large to fit within the maximum size of <em>buffer</em> and to also remain within 65535 bytes.</dd></dl>
<p>The plaintext is encrypted in-place with the ciphertext also written to <em>buffer</em>. There must be enough room on the end of <em>buffer</em> to hold the extra MAC value that will be appended. In other words, it is assumed that the plaintext is in an output buffer ready to be transmitted once the data has been encrypted and the final packet length has been determined.</p>
<p>The <a class="el" href="group__symmetricstate.html#ga7c6c8d15eb40a3de6b2a5f8457bee820" title="Gets the current length of packet MAC values for a SymmetricState object. ">noise_symmetricstate_get_mac_length()</a> function can be used to determine the size of the MAC value that will be added, which may be zero if the encryption key has not been set up yet.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__symmetricstate.html#ga278bd4948592b1c5609df3657bd61b07" title="Decrypts a block of data with this SymmetricState object and adds the ciphertext to the handshake has...">noise_symmetricstate_decrypt_and_hash()</a>, <a class="el" href="group__symmetricstate.html#ga7c6c8d15eb40a3de6b2a5f8457bee820" title="Gets the current length of packet MAC values for a SymmetricState object. ">noise_symmetricstate_get_mac_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00353">353</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga6577c4265dd0cd484de5485a4b829cb9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_symmetricstate_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a SymmetricState object after destroying all sensitive material. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The SymmetricState object to free.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__symmetricstate.html#ga8198aa2fea89f65139360558ee622aed" title="Creates a new SymmetricState object from a protocol identifier. ">noise_symmetricstate_new_by_id()</a>, <a class="el" href="group__symmetricstate.html#ga29d5f792aa9dc3cbff5609ff0bbce543" title="Creates a new SymmetricState object from a protocol name. ">noise_symmetricstate_new_by_name()</a> </dd></dl>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00209">209</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga7c6c8d15eb40a3de6b2a5f8457bee820"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t noise_symmetricstate_get_mac_length </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the current length of packet MAC values for a SymmetricState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The SymmetricState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the MAC in bytes. Returns zero if <em>state</em> is NULL, the encryption key has not been set yet, or the SymmetricState has been split.</dd></dl>
<p>This function can be used to determine the size of the MAC value that will be added to the next packet that will be encrypted with <a class="el" href="group__symmetricstate.html#gafb445fe2e3796abb8aabaf198ed5fd8b" title="Encrypts a block of data with this SymmetricState object and adds the ciphertext to the handshake has...">noise_symmetricstate_encrypt_and_hash()</a>. Early in the handshake when packets are still being exchanged in plaintext, the size will be zero.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__symmetricstate.html#gafb445fe2e3796abb8aabaf198ed5fd8b" title="Encrypts a block of data with this SymmetricState object and adds the ciphertext to the handshake has...">noise_symmetricstate_encrypt_and_hash()</a> </dd></dl>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00464">464</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga9e8ec56dd66b6fe9f04cf9ff1f144b79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_symmetricstate_get_protocol_id </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__names.html#structNoiseProtocolId">NoiseProtocolId</a> *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the protocol identifier associated with a SymmetricState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The SymmetricState object. </td></tr>
    <tr><td class="paramname">id</td><td>Return buffer for the protocol identifier, which consists of fields that identify the cipher algorithm, hash algorith, handshake pattern, etc.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>id</em> is NULL. </dd></dl>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00238">238</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga88c5f5a80bc4984eff45cacdce01d11c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_symmetricstate_mix_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mixes new input data into the handshake hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The SymmetricState object. </td></tr>
    <tr><td class="paramname">input</td><td>Points to the input data to mix in. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the <em>input</em> data in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>input</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if the <em>state</em> has already been split.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__symmetricstate.html#gac792150120af1e5f6f45ebb42023b35a" title="Mixes new input data into the chaining key. ">noise_symmetricstate_mix_key()</a>, <a class="el" href="group__symmetricstate.html#gadcb03d5b22400016e003a8d62d0790e1" title="Splits the transport encryption CipherState objects out of this SymmetricState object. ">noise_symmetricstate_split()</a> </dd></dl>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00304">304</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gac792150120af1e5f6f45ebb42023b35a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_symmetricstate_mix_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mixes new input data into the chaining key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The SymmetricState object. </td></tr>
    <tr><td class="paramname">input</td><td>Points to the input data to mix in. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the <em>input</em> data in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>input</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if the <em>state</em> has already been split.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__symmetricstate.html#ga88c5f5a80bc4984eff45cacdce01d11c" title="Mixes new input data into the handshake hash. ">noise_symmetricstate_mix_hash()</a>, <a class="el" href="group__symmetricstate.html#gadcb03d5b22400016e003a8d62d0790e1" title="Splits the transport encryption CipherState objects out of this SymmetricState object. ">noise_symmetricstate_split()</a> </dd></dl>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00263">263</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga8198aa2fea89f65139360558ee622aed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_symmetricstate_new_by_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> **&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__names.html#structNoiseProtocolId">NoiseProtocolId</a> *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new SymmetricState object from a protocol identifier. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Points to the variable where to store the pointer to the new SymmetricState object. </td></tr>
    <tr><td class="paramname">id</td><td>The protocol identifier as a set of algorithm identifiers.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>id</em> is NULL. </dd>
<dd>
NOISE_ERROR_UNKNOWN_ID if the protocol <em>id</em> is unknown. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if the full name corresponding to <em>id</em> is too long. </dd>
<dd>
NOISE_ERROR_NOT_APPLICABLE if the lengths of the hash output or the cipher key are incompatible. </dd>
<dd>
NOISE_ERROR_NO_MEMORY if there is insufficient memory to allocate the new SymmetricState object.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__symmetricstate.html#ga6577c4265dd0cd484de5485a4b829cb9" title="Frees a SymmetricState object after destroying all sensitive material. ">noise_symmetricstate_free()</a>, <a class="el" href="group__symmetricstate.html#ga29d5f792aa9dc3cbff5609ff0bbce543" title="Creates a new SymmetricState object from a protocol name. ">noise_symmetricstate_new_by_name()</a> </dd></dl>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00135">135</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga29d5f792aa9dc3cbff5609ff0bbce543"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_symmetricstate_new_by_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> **&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new SymmetricState object from a protocol name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Points to the variable where to store the pointer to the new SymmetricState object. </td></tr>
    <tr><td class="paramname">name</td><td>The name of the Noise protocol to use. This string must be NUL-terminated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>name</em> is NULL. </dd>
<dd>
NOISE_ERROR_UNKNOWN_NAME if the protocol <em>name</em> is unknown. </dd>
<dd>
NOISE_ERROR_NOT_APPLICABLE if the lengths of the hash output or the cipher key are incompatible. </dd>
<dd>
NOISE_ERROR_NO_MEMORY if there is insufficient memory to allocate the new SymmetricState object.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__symmetricstate.html#ga6577c4265dd0cd484de5485a4b829cb9" title="Frees a SymmetricState object after destroying all sensitive material. ">noise_symmetricstate_free()</a>, <a class="el" href="group__symmetricstate.html#ga8198aa2fea89f65139360558ee622aed" title="Creates a new SymmetricState object from a protocol identifier. ">noise_symmetricstate_new_by_id()</a> </dd></dl>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00176">176</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gadcb03d5b22400016e003a8d62d0790e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_symmetricstate_split </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__symmetricstate.html#gaafb7dab7644f6ebb68fbd3a9c7b1c32c">NoiseSymmetricState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **&#160;</td>
          <td class="paramname"><em>c1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **&#160;</td>
          <td class="paramname"><em>c2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>secondary_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>secondary_key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Splits the transport encryption CipherState objects out of this SymmetricState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The SymmetricState object. </td></tr>
    <tr><td class="paramname">c1</td><td>Points to the variable where to place the pointer to the first CipherState object. This can be NULL if the application is using a one-way handshake pattern. </td></tr>
    <tr><td class="paramname">c2</td><td>Points to the variable where to place the pointer to the second CipherState object. This can be NULL if the application is using a one-way handshake pattern. </td></tr>
    <tr><td class="paramname">secondary_key</td><td>Points to an optional "secondary symmetric key" from a parallel non-DH handshake to mix into the final cipher keys. This may be NULL if <em>secondary_key_len</em> is zero. </td></tr>
    <tr><td class="paramname">secondary_key_len</td><td>Length of <em>secondary_key</em> in bytes. This must be either zero or 32 to comply with the requirements from the Noise protocol specification.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if both <em>c1</em> and <em>c2</em> are NULL. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>secondary_key</em> is NULL and <em>secondary_key_len</em> is not zero. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>secondary_key_len</em> is not zero or 32. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if the <em>state</em> has already been split. </dd>
<dd>
NOISE_ERROR_NO_MEMORY if there is insufficient memory to create the new CipherState objects.</dd></dl>
<p>Once a SymmetricState has been split, it is effectively finished and cannot be used for future encryption or hashing operations. If those operations are invoked, the relevant functions will return NOISE_ERROR_INVALID_STATE.</p>
<p>The <em>c1</em> object should be used to protect messages from the initiator to the responder, and the <em>c2</em> object should be used to protect messages from the responder to the initiator.</p>
<p>If the handshake pattern is one-way, then the application should call <a class="el" href="group__cipherstate.html#ga407f8ce7855758296400eff1eb6c065a" title="Frees a CipherState object after destroying all sensitive material. ">noise_cipherstate_free()</a> on the object that is not needed. Alternatively, the application can pass NULL to <a class="el" href="group__symmetricstate.html#gadcb03d5b22400016e003a8d62d0790e1" title="Splits the transport encryption CipherState objects out of this SymmetricState object. ">noise_symmetricstate_split()</a> as the <em>c1</em> or <em>c2</em> argument and the second CipherState will not be created at all. </p>

<p>Definition at line <a class="el" href="symmetricstate_8c_source.html#l00524">524</a> of file <a class="el" href="symmetricstate_8c_source.html">symmetricstate.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 28 2016 11:02:54 for Noise-C by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
