<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Noise-C: CipherState API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Noise-C
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CipherState API</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaed43ed8af5dd6f1a8ce2246c5bb00dc1"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structNoiseCipherState__s.html">NoiseCipherState_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a></td></tr>
<tr class="memdesc:gaed43ed8af5dd6f1a8ce2246c5bb00dc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque object that represents a CipherState.  <a href="#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">More...</a><br/></td></tr>
<tr class="separator:gaed43ed8af5dd6f1a8ce2246c5bb00dc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5a50b9a3d28358876361d3a056fdc9e9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga5a50b9a3d28358876361d3a056fdc9e9">noise_cipherstate_decrypt</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, <a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *buffer)</td></tr>
<tr class="memdesc:ga5a50b9a3d28358876361d3a056fdc9e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a block of data with this CipherState object.  <a href="#ga5a50b9a3d28358876361d3a056fdc9e9">More...</a><br/></td></tr>
<tr class="separator:ga5a50b9a3d28358876361d3a056fdc9e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5b626f9fafa5173c9abe60e30e8148b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga5b626f9fafa5173c9abe60e30e8148b2">noise_cipherstate_decrypt_with_ad</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, const uint8_t *ad, size_t ad_len, <a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *buffer)</td></tr>
<tr class="memdesc:ga5b626f9fafa5173c9abe60e30e8148b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a block of data with this CipherState object.  <a href="#ga5b626f9fafa5173c9abe60e30e8148b2">More...</a><br/></td></tr>
<tr class="separator:ga5b626f9fafa5173c9abe60e30e8148b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga424497503985e208370d2f159df032ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga424497503985e208370d2f159df032ab">noise_cipherstate_derive</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, uint8_t *data, size_t len)</td></tr>
<tr class="memdesc:ga424497503985e208370d2f159df032ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives key material from the CipherState for use in a future session.  <a href="#ga424497503985e208370d2f159df032ab">More...</a><br/></td></tr>
<tr class="separator:ga424497503985e208370d2f159df032ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e764ac8cb75e3da216987232255b9b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga0e764ac8cb75e3da216987232255b9b9">noise_cipherstate_encrypt</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, <a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *buffer)</td></tr>
<tr class="memdesc:ga0e764ac8cb75e3da216987232255b9b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts a block of data with this CipherState object.  <a href="#ga0e764ac8cb75e3da216987232255b9b9">More...</a><br/></td></tr>
<tr class="separator:ga0e764ac8cb75e3da216987232255b9b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11123cb18f5d28e0fd4ed3e700aafeaa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga11123cb18f5d28e0fd4ed3e700aafeaa">noise_cipherstate_encrypt_with_ad</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, const uint8_t *ad, size_t ad_len, <a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *buffer)</td></tr>
<tr class="memdesc:ga11123cb18f5d28e0fd4ed3e700aafeaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts a block of data with this CipherState object.  <a href="#ga11123cb18f5d28e0fd4ed3e700aafeaa">More...</a><br/></td></tr>
<tr class="separator:ga11123cb18f5d28e0fd4ed3e700aafeaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga407f8ce7855758296400eff1eb6c065a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga407f8ce7855758296400eff1eb6c065a">noise_cipherstate_free</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:ga407f8ce7855758296400eff1eb6c065a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a CipherState object after destroying all sensitive material.  <a href="#ga407f8ce7855758296400eff1eb6c065a">More...</a><br/></td></tr>
<tr class="separator:ga407f8ce7855758296400eff1eb6c065a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f0813b96f29325f5e1937ab80012c1f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga5f0813b96f29325f5e1937ab80012c1f">noise_cipherstate_get_cipher_id</a> (const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:ga5f0813b96f29325f5e1937ab80012c1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the algorithm identifier for a CipherState object.  <a href="#ga5f0813b96f29325f5e1937ab80012c1f">More...</a><br/></td></tr>
<tr class="separator:ga5f0813b96f29325f5e1937ab80012c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf2e1035f4d0b85154176d9a3042eee81"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gaf2e1035f4d0b85154176d9a3042eee81">noise_cipherstate_get_key_length</a> (const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:gaf2e1035f4d0b85154176d9a3042eee81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the length of the encryption key for a CipherState object.  <a href="#gaf2e1035f4d0b85154176d9a3042eee81">More...</a><br/></td></tr>
<tr class="separator:gaf2e1035f4d0b85154176d9a3042eee81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae96037b3451f22ac86e51cfc177a06ad"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gae96037b3451f22ac86e51cfc177a06ad">noise_cipherstate_get_mac_length</a> (const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:gae96037b3451f22ac86e51cfc177a06ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the length of packet MAC values for a CipherState object.  <a href="#gae96037b3451f22ac86e51cfc177a06ad">More...</a><br/></td></tr>
<tr class="separator:gae96037b3451f22ac86e51cfc177a06ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2c5e268f44e795c1b87d95cd2c6f7c77"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga2c5e268f44e795c1b87d95cd2c6f7c77">noise_cipherstate_get_max_key_length</a> (void)</td></tr>
<tr class="memdesc:ga2c5e268f44e795c1b87d95cd2c6f7c77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the maximum key length for the supported algorithms.  <a href="#ga2c5e268f44e795c1b87d95cd2c6f7c77">More...</a><br/></td></tr>
<tr class="separator:ga2c5e268f44e795c1b87d95cd2c6f7c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea3c5e6b6653ae43054a3e6153f275aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gaea3c5e6b6653ae43054a3e6153f275aa">noise_cipherstate_get_max_mac_length</a> (void)</td></tr>
<tr class="memdesc:gaea3c5e6b6653ae43054a3e6153f275aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the maximum MAC length for the supported algorithms.  <a href="#gaea3c5e6b6653ae43054a3e6153f275aa">More...</a><br/></td></tr>
<tr class="separator:gaea3c5e6b6653ae43054a3e6153f275aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c8497c3f9682d6ac5b6cbce58a4a9e3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga7c8497c3f9682d6ac5b6cbce58a4a9e3">noise_cipherstate_has_key</a> (const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:ga7c8497c3f9682d6ac5b6cbce58a4a9e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the key has been set on a CipherState object.  <a href="#ga7c8497c3f9682d6ac5b6cbce58a4a9e3">More...</a><br/></td></tr>
<tr class="separator:ga7c8497c3f9682d6ac5b6cbce58a4a9e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac10e4b2b02a43c1e1e23253420eea1d0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gac10e4b2b02a43c1e1e23253420eea1d0">noise_cipherstate_init_key</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, const uint8_t *key, size_t key_len)</td></tr>
<tr class="memdesc:gac10e4b2b02a43c1e1e23253420eea1d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the key on a CipherState object.  <a href="#gac10e4b2b02a43c1e1e23253420eea1d0">More...</a><br/></td></tr>
<tr class="separator:gac10e4b2b02a43c1e1e23253420eea1d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83cc7e0f12b78373523cdb054cad2a0e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga83cc7e0f12b78373523cdb054cad2a0e">noise_cipherstate_new_by_id</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **state, int id)</td></tr>
<tr class="memdesc:ga83cc7e0f12b78373523cdb054cad2a0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new CipherState object by its algorithm identifier.  <a href="#ga83cc7e0f12b78373523cdb054cad2a0e">More...</a><br/></td></tr>
<tr class="separator:ga83cc7e0f12b78373523cdb054cad2a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad028a9c95917d2e5f148c317bfaa9696"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gad028a9c95917d2e5f148c317bfaa9696">noise_cipherstate_new_by_name</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **state, const char *name)</td></tr>
<tr class="memdesc:gad028a9c95917d2e5f148c317bfaa9696"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new CipherState object by its algorithm name.  <a href="#gad028a9c95917d2e5f148c317bfaa9696">More...</a><br/></td></tr>
<tr class="separator:gad028a9c95917d2e5f148c317bfaa9696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a10548dfc0948bb2e29ac416dc8a901"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga3a10548dfc0948bb2e29ac416dc8a901">noise_cipherstate_set_nonce</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, uint64_t nonce)</td></tr>
<tr class="memdesc:ga3a10548dfc0948bb2e29ac416dc8a901"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the nonce value for this cipherstate object.  <a href="#ga3a10548dfc0948bb2e29ac416dc8a901">More...</a><br/></td></tr>
<tr class="separator:ga3a10548dfc0948bb2e29ac416dc8a901"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>CipherState objects are used to encrypt or decrypt data during a session. Once the handshake has completed, <a class="el" href="group__symmetricstate.html#gadcb03d5b22400016e003a8d62d0790e1" title="Splits the transport encryption CipherState objects out of this SymmetricState object. ">noise_symmetricstate_split()</a> will create two CipherState objects for encrypting packets sent to the other party, and decrypting packets received from the other party. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gaed43ed8af5dd6f1a8ce2246c5bb00dc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opaque object that represents a CipherState. </p>

<p>Definition at line <a class="el" href="cipherstate_8h_source.html#l00032">32</a> of file <a class="el" href="cipherstate_8h_source.html">cipherstate.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga5a50b9a3d28358876361d3a056fdc9e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a block of data with this CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer containing the ciphertext plus MAC on entry and the plaintext on exit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>buffer</em> is NULL. </dd>
<dd>
NOISE_ERROR_MAC_FAILURE if the MAC check failed. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if the nonce previously overflowed. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if the size of <em>buffer</em> is larger than 65535 bytes or is too small to contain the MAC value.</dd></dl>
<p>This is a convenience function which decrypts the contents of a buffer without any associated data. It is otherwise identical to <a class="el" href="group__cipherstate.html#ga5b626f9fafa5173c9abe60e30e8148b2" title="Decrypts a block of data with this CipherState object. ">noise_cipherstate_decrypt_with_ad()</a>.</p>
<p>The ciphertext is decrypted in-place with the plaintext also written to <em>buffer</em>. In other words, it is assumed that the ciphertext plus MAC is in an input buffer ready to be processed once the MAC has been checked and the ciphertext has been decrypted.</p>
<p>The following example demonstrates how to initialize a buffer for use with this function. The <code>message</code> is a byte array containing <code>ciphertext_size</code> bytes of ciphertext plus MAC on entry. On exit, <code>buffer.size</code> will contain the number of bytes of plaintext:</p>
<div class="fragment"><div class="line"><a class="code" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> buffer;</div>
<div class="line"><a class="code" href="group__buffer__management.html#gae048fb0cd83e3afb72292dc67690c9ad">noise_buffer_set_inout</a>(buffer, message, ciphertext_size, <span class="keyword">sizeof</span>(message));</div>
<div class="line"><a class="code" href="group__cipherstate.html#ga5a50b9a3d28358876361d3a056fdc9e9">noise_cipherstate_decrypt</a>(state, &amp;buffer);</div>
<div class="line"><span class="comment">// The plaintext is the buffer.size bytes starting at buffer.data</span></div>
</div><!-- fragment --><dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga5b626f9fafa5173c9abe60e30e8148b2" title="Decrypts a block of data with this CipherState object. ">noise_cipherstate_decrypt_with_ad()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00493">493</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga5b626f9fafa5173c9abe60e30e8148b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_decrypt_with_ad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a block of data with this CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">ad</td><td>Points to the associated data, which can be NULL only if <em>ad_len</em> is zero. </td></tr>
    <tr><td class="paramname">ad_len</td><td>The length of the associated data in bytes. </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer containing the ciphertext plus MAC on entry and the plaintext on exit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>buffer</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>ad</em> is NULL and <em>ad_len</em> is not zero. </dd>
<dd>
NOISE_ERROR_MAC_FAILURE if the MAC check failed. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if the nonce previously overflowed. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if the size of <em>buffer</em> is larger than 65535 bytes or is too small to contain the MAC value.</dd></dl>
<p>The ciphertext is decrypted in-place with the plaintext also written to <em>buffer</em>. In other words, it is assumed that the ciphertext plus MAC is in an input buffer ready to be processed once the MAC has been checked and the ciphertext has been decrypted.</p>
<p>The following example demonstrates how to initialize a buffer for use with this function. The <code>message</code> is a byte array containing <code>ciphertext_size</code> bytes of ciphertext plus MAC on entry. On exit, <code>buffer.size</code> will contain the number of bytes of plaintext:</p>
<div class="fragment"><div class="line"><a class="code" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> buffer;</div>
<div class="line"><a class="code" href="group__buffer__management.html#gae048fb0cd83e3afb72292dc67690c9ad">noise_buffer_set_inout</a>(buffer, message, ciphertext_size, <span class="keyword">sizeof</span>(message));</div>
<div class="line"><a class="code" href="group__cipherstate.html#ga5b626f9fafa5173c9abe60e30e8148b2">noise_cipherstate_decrypt_with_ad</a>(state, ad, ad_len, &amp;buffer);</div>
<div class="line"><span class="comment">// The plaintext is the buffer.size bytes starting at buffer.data</span></div>
</div><!-- fragment --><dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga11123cb18f5d28e0fd4ed3e700aafeaa" title="Encrypts a block of data with this CipherState object. ">noise_cipherstate_encrypt_with_ad()</a>, <a class="el" href="group__cipherstate.html#gae96037b3451f22ac86e51cfc177a06ad" title="Gets the length of packet MAC values for a CipherState object. ">noise_cipherstate_get_mac_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00374">374</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga424497503985e208370d2f159df032ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_derive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derives key material from the CipherState for use in a future session. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">data</td><td>Points to the buffer to fill with derived key material. </td></tr>
    <tr><td class="paramname">len</td><td>The length of the key material, which must be 32.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>data</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>len</em> is not 32. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if <a class="el" href="group__cipherstate.html#ga7c8497c3f9682d6ac5b6cbce58a4a9e3" title="Determine if the key has been set on a CipherState object. ">noise_cipherstate_has_key()</a> is false.</dd></dl>
<p>This function is intended for use with resumption patterns and nested post-quantum handshakes to generate PSK or SSK key material to pass from one handshake to another.</p>
<p>Warning: Every time this function is called it will return the same 32 bytes of key material until such time that <a class="el" href="group__cipherstate.html#gac10e4b2b02a43c1e1e23253420eea1d0" title="Initializes the key on a CipherState object. ">noise_cipherstate_init_key()</a> is called to establish a new encryption key. This function should therefore be called only once when the current session is about to be terminated. </p>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00520">520</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga0e764ac8cb75e3da216987232255b9b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts a block of data with this CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer containing the plaintext on entry and the ciphertext plus MAC on exit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>buffer</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if the nonce previously overflowed. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if the ciphertext plus MAC is too large to fit within the maximum size of <em>buffer</em> and to also remain within 65535 bytes.</dd></dl>
<p>This is a convenience function which encrypts the contents of a buffer without any associated data. It is otherwise identical to <a class="el" href="group__cipherstate.html#ga11123cb18f5d28e0fd4ed3e700aafeaa" title="Encrypts a block of data with this CipherState object. ">noise_cipherstate_encrypt_with_ad()</a>.</p>
<p>The plaintext is encrypted in-place with the ciphertext also written to <em>buffer</em>. There must be enough room on the end of <em>buffer</em> to hold the extra MAC value that will be appended. In other words, it is assumed that the plaintext is in an output buffer ready to be transmitted once the data has been encrypted and the final packet length has been determined.</p>
<p>The following example demonstrates how to initialize a buffer for use with this function. The <code>message</code> is a byte array containing <code>plaintext_size</code> bytes of plaintext on entry. On exit, <code>buffer.size</code> will contain the number of bytes of ciphertext plus MAC to be transmitted:</p>
<div class="fragment"><div class="line"><a class="code" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> buffer;</div>
<div class="line"><a class="code" href="group__buffer__management.html#gae048fb0cd83e3afb72292dc67690c9ad">noise_buffer_set_inout</a>(buffer, message, plaintext_size, <span class="keyword">sizeof</span>(message));</div>
<div class="line"><a class="code" href="group__cipherstate.html#ga0e764ac8cb75e3da216987232255b9b9">noise_cipherstate_encrypt</a>(state, &amp;buffer);</div>
<div class="line"><span class="comment">// Transmit the buffer.size bytes starting at buffer.data</span></div>
</div><!-- fragment --><dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga11123cb18f5d28e0fd4ed3e700aafeaa" title="Encrypts a block of data with this CipherState object. ">noise_cipherstate_encrypt_with_ad()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00451">451</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga11123cb18f5d28e0fd4ed3e700aafeaa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_encrypt_with_ad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts a block of data with this CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">ad</td><td>Points to the associated data, which can be NULL only if <em>ad_len</em> is zero. </td></tr>
    <tr><td class="paramname">ad_len</td><td>The length of the associated data in bytes. </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer containing the plaintext on entry and the ciphertext plus MAC on exit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>buffer</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>ad</em> is NULL and <em>ad_len</em> is not zero. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if the nonce previously overflowed. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if the ciphertext plus MAC is too large to fit within the maximum size of <em>buffer</em> and to also remain within 65535 bytes.</dd></dl>
<p>The plaintext is encrypted in-place with the ciphertext also written to <em>buffer</em>. There must be enough room on the end of <em>buffer</em> to hold the extra MAC value that will be appended. In other words, it is assumed that the plaintext is in an output buffer ready to be transmitted once the data has been encrypted and the final packet length has been determined.</p>
<p>The following example demonstrates how to initialize a buffer for use with this function. The <code>message</code> is a byte array containing <code>plaintext_size</code> bytes of plaintext on entry. On exit, <code>buffer.size</code> will contain the number of bytes of ciphertext plus MAC to be transmitted:</p>
<div class="fragment"><div class="line"><a class="code" href="group__buffer__management.html#structNoiseBuffer">NoiseBuffer</a> buffer;</div>
<div class="line"><a class="code" href="group__buffer__management.html#gae048fb0cd83e3afb72292dc67690c9ad">noise_buffer_set_inout</a>(buffer, message, plaintext_size, <span class="keyword">sizeof</span>(message));</div>
<div class="line"><a class="code" href="group__cipherstate.html#ga11123cb18f5d28e0fd4ed3e700aafeaa">noise_cipherstate_encrypt_with_ad</a>(state, ad, ad_len, &amp;buffer);</div>
<div class="line"><span class="comment">// Transmit the buffer.size bytes starting at buffer.data</span></div>
</div><!-- fragment --><dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga5b626f9fafa5173c9abe60e30e8148b2" title="Decrypts a block of data with this CipherState object. ">noise_cipherstate_decrypt_with_ad()</a>, <a class="el" href="group__cipherstate.html#gae96037b3451f22ac86e51cfc177a06ad" title="Gets the length of packet MAC values for a CipherState object. ">noise_cipherstate_get_mac_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00294">294</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga407f8ce7855758296400eff1eb6c065a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a CipherState object after destroying all sensitive material. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object to free.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga83cc7e0f12b78373523cdb054cad2a0e" title="Creates a new CipherState object by its algorithm identifier. ">noise_cipherstate_new_by_id()</a>, <a class="el" href="group__cipherstate.html#gad028a9c95917d2e5f148c317bfaa9696" title="Creates a new CipherState object by its algorithm name. ">noise_cipherstate_new_by_name()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00152">152</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga5f0813b96f29325f5e1937ab80012c1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_get_cipher_id </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the algorithm identifier for a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The algorithm identifier, or NOISE_CIPHER_NONE if <em>state</em> is NULL. </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00174">174</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaf2e1035f4d0b85154176d9a3042eee81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t noise_cipherstate_get_key_length </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the length of the encryption key for a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the key in bytes, or 0 if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gae96037b3451f22ac86e51cfc177a06ad" title="Gets the length of packet MAC values for a CipherState object. ">noise_cipherstate_get_mac_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00188">188</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gae96037b3451f22ac86e51cfc177a06ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t noise_cipherstate_get_mac_length </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the length of packet MAC values for a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the MAC in bytes, or 0 if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gaf2e1035f4d0b85154176d9a3042eee81" title="Gets the length of the encryption key for a CipherState object. ">noise_cipherstate_get_key_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00202">202</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga2c5e268f44e795c1b87d95cd2c6f7c77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_get_max_key_length </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the maximum key length for the supported algorithms. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gaea3c5e6b6653ae43054a3e6153f275aa" title="Gets the maximum MAC length for the supported algorithms. ">noise_cipherstate_get_max_mac_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00596">596</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaea3c5e6b6653ae43054a3e6153f275aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_get_max_mac_length </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the maximum MAC length for the supported algorithms. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga2c5e268f44e795c1b87d95cd2c6f7c77" title="Gets the maximum key length for the supported algorithms. ">noise_cipherstate_get_max_key_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00606">606</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga7c8497c3f9682d6ac5b6cbce58a4a9e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_has_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the key has been set on a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 if the key has been set, or 0 if the key has not been set (or <em>state</em> is NULL).</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gac10e4b2b02a43c1e1e23253420eea1d0" title="Initializes the key on a CipherState object. ">noise_cipherstate_init_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00247">247</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gac10e4b2b02a43c1e1e23253420eea1d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_init_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the key on a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">key</td><td>Points to the key. </td></tr>
    <tr><td class="paramname">key_len</td><td>The length of the key in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>key</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>key_len</em> is the wrong length for this cipher.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gaf2e1035f4d0b85154176d9a3042eee81" title="Gets the length of the encryption key for a CipherState object. ">noise_cipherstate_get_key_length()</a>, <a class="el" href="group__cipherstate.html#ga7c8497c3f9682d6ac5b6cbce58a4a9e3" title="Determine if the key has been set on a CipherState object. ">noise_cipherstate_has_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00222">222</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga83cc7e0f12b78373523cdb054cad2a0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_new_by_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new CipherState object by its algorithm identifier. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Points to the variable where to store the pointer to the new CipherState object. </td></tr>
    <tr><td class="paramname">id</td><td>The algorithm identifier; NOISE_CIPHER_CHACHAPOLY, NOISE_CIPHER_AESGCM, etc.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL. </dd>
<dd>
NOISE_ERROR_UNKNOWN_ID if <em>id</em> is unknown. </dd>
<dd>
or NOISE_ERROR_NO_MEMORY if there is insufficient memory to allocate the new CipherState object.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga407f8ce7855758296400eff1eb6c065a" title="Frees a CipherState object after destroying all sensitive material. ">noise_cipherstate_free()</a>, <a class="el" href="group__cipherstate.html#gad028a9c95917d2e5f148c317bfaa9696" title="Creates a new CipherState object by its algorithm name. ">noise_cipherstate_new_by_name()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00077">77</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gad028a9c95917d2e5f148c317bfaa9696"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_new_by_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new CipherState object by its algorithm name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Points to the variable where to store the pointer to the new CipherState object. </td></tr>
    <tr><td class="paramname">name</td><td>The name of the cipher algorithm; e.g. "ChaChaPoly". This string must be NUL-terminated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>name</em> is NULL. </dd>
<dd>
NOISE_ERROR_UNKNOWN_NAME if <em>name</em> is unknown. </dd>
<dd>
NOISE_ERROR_NO_MEMORY if there is insufficient memory to allocate the new CipherState object.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga407f8ce7855758296400eff1eb6c065a" title="Frees a CipherState object after destroying all sensitive material. ">noise_cipherstate_free()</a>, <a class="el" href="group__cipherstate.html#ga83cc7e0f12b78373523cdb054cad2a0e" title="Creates a new CipherState object by its algorithm identifier. ">noise_cipherstate_new_by_id()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00122">122</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga3a10548dfc0948bb2e29ac416dc8a901"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_set_nonce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>nonce</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the nonce value for this cipherstate object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">nonce</td><td>The new nonce value to set. This must be greater than or equal to the current nonce value in the state.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if the key has not been set yet. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if <em>nonce</em> is smaller than the current value.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function is intended for testing purposes only. It is dangerous to set the nonce back to a previously-used value so this function will actively prevent that from happening.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gac10e4b2b02a43c1e1e23253420eea1d0" title="Initializes the key on a CipherState object. ">noise_cipherstate_init_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00572">572</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 15 2016 20:01:07 for Noise-C by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
