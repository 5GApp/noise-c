<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Noise-C: CipherState API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Noise-C
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CipherState API</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaed43ed8af5dd6f1a8ce2246c5bb00dc1"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structNoiseCipherState__s.html">NoiseCipherState_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a></td></tr>
<tr class="memdesc:gaed43ed8af5dd6f1a8ce2246c5bb00dc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque object that represents a CipherState.  <a href="#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">More...</a><br/></td></tr>
<tr class="separator:gaed43ed8af5dd6f1a8ce2246c5bb00dc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga147f818d2466e7c3a1cbab91ca631bba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga147f818d2466e7c3a1cbab91ca631bba">noise_cipherstate_decrypt_with_ad</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, const uint8_t *ad, size_t ad_len, uint8_t *data, size_t in_data_len, size_t *out_data_len)</td></tr>
<tr class="memdesc:ga147f818d2466e7c3a1cbab91ca631bba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a block of data with this CipherState object.  <a href="#ga147f818d2466e7c3a1cbab91ca631bba">More...</a><br/></td></tr>
<tr class="separator:ga147f818d2466e7c3a1cbab91ca631bba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaba9d99ad1068e4aa1a6b49e1ef83827e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gaba9d99ad1068e4aa1a6b49e1ef83827e">noise_cipherstate_encrypt_with_ad</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, const uint8_t *ad, size_t ad_len, uint8_t *data, size_t in_data_len, size_t *out_data_len)</td></tr>
<tr class="memdesc:gaba9d99ad1068e4aa1a6b49e1ef83827e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts a block of data with this CipherState object.  <a href="#gaba9d99ad1068e4aa1a6b49e1ef83827e">More...</a><br/></td></tr>
<tr class="separator:gaba9d99ad1068e4aa1a6b49e1ef83827e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga407f8ce7855758296400eff1eb6c065a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga407f8ce7855758296400eff1eb6c065a">noise_cipherstate_free</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:ga407f8ce7855758296400eff1eb6c065a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a CipherState object after destroying all sensitive material.  <a href="#ga407f8ce7855758296400eff1eb6c065a">More...</a><br/></td></tr>
<tr class="separator:ga407f8ce7855758296400eff1eb6c065a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f0813b96f29325f5e1937ab80012c1f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga5f0813b96f29325f5e1937ab80012c1f">noise_cipherstate_get_cipher_id</a> (const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:ga5f0813b96f29325f5e1937ab80012c1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the algorithm identifier for a CipherState object.  <a href="#ga5f0813b96f29325f5e1937ab80012c1f">More...</a><br/></td></tr>
<tr class="separator:ga5f0813b96f29325f5e1937ab80012c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf2e1035f4d0b85154176d9a3042eee81"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gaf2e1035f4d0b85154176d9a3042eee81">noise_cipherstate_get_key_length</a> (const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:gaf2e1035f4d0b85154176d9a3042eee81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the length of the encryption key for a CipherState object.  <a href="#gaf2e1035f4d0b85154176d9a3042eee81">More...</a><br/></td></tr>
<tr class="separator:gaf2e1035f4d0b85154176d9a3042eee81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae96037b3451f22ac86e51cfc177a06ad"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gae96037b3451f22ac86e51cfc177a06ad">noise_cipherstate_get_mac_length</a> (const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:gae96037b3451f22ac86e51cfc177a06ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the length of packet MAC values for a CipherState object.  <a href="#gae96037b3451f22ac86e51cfc177a06ad">More...</a><br/></td></tr>
<tr class="separator:gae96037b3451f22ac86e51cfc177a06ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c8497c3f9682d6ac5b6cbce58a4a9e3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga7c8497c3f9682d6ac5b6cbce58a4a9e3">noise_cipherstate_has_key</a> (const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state)</td></tr>
<tr class="memdesc:ga7c8497c3f9682d6ac5b6cbce58a4a9e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the key has been set on a CipherState object.  <a href="#ga7c8497c3f9682d6ac5b6cbce58a4a9e3">More...</a><br/></td></tr>
<tr class="separator:ga7c8497c3f9682d6ac5b6cbce58a4a9e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac10e4b2b02a43c1e1e23253420eea1d0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gac10e4b2b02a43c1e1e23253420eea1d0">noise_cipherstate_init_key</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, const uint8_t *key, size_t key_len)</td></tr>
<tr class="memdesc:gac10e4b2b02a43c1e1e23253420eea1d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the key on a CipherState object.  <a href="#gac10e4b2b02a43c1e1e23253420eea1d0">More...</a><br/></td></tr>
<tr class="separator:gac10e4b2b02a43c1e1e23253420eea1d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83cc7e0f12b78373523cdb054cad2a0e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga83cc7e0f12b78373523cdb054cad2a0e">noise_cipherstate_new_by_id</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **state, int id)</td></tr>
<tr class="memdesc:ga83cc7e0f12b78373523cdb054cad2a0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new CipherState object by its algorithm identifier.  <a href="#ga83cc7e0f12b78373523cdb054cad2a0e">More...</a><br/></td></tr>
<tr class="separator:ga83cc7e0f12b78373523cdb054cad2a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad028a9c95917d2e5f148c317bfaa9696"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gad028a9c95917d2e5f148c317bfaa9696">noise_cipherstate_new_by_name</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **state, const char *name)</td></tr>
<tr class="memdesc:gad028a9c95917d2e5f148c317bfaa9696"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new CipherState object by its algorithm name.  <a href="#gad028a9c95917d2e5f148c317bfaa9696">More...</a><br/></td></tr>
<tr class="separator:gad028a9c95917d2e5f148c317bfaa9696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacf9f934dd976784f58aef4088a4f7b7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gacf9f934dd976784f58aef4088a4f7b7d">noise_cipherstate_pad</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, uint8_t *payload, size_t orig_len, size_t padded_len, int padding_mode)</td></tr>
<tr class="memdesc:gacf9f934dd976784f58aef4088a4f7b7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds padding bytes to the end of a message payload.  <a href="#gacf9f934dd976784f58aef4088a4f7b7d">More...</a><br/></td></tr>
<tr class="separator:gacf9f934dd976784f58aef4088a4f7b7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga516ad81b9355cba6ab08c18fa3cf7479"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga516ad81b9355cba6ab08c18fa3cf7479">noise_cipherstate_rand_bytes</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, uint8_t *buffer, size_t len, int force_reseed)</td></tr>
<tr class="memdesc:ga516ad81b9355cba6ab08c18fa3cf7479"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates random bytes for use by the application.  <a href="#ga516ad81b9355cba6ab08c18fa3cf7479">More...</a><br/></td></tr>
<tr class="separator:ga516ad81b9355cba6ab08c18fa3cf7479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a10548dfc0948bb2e29ac416dc8a901"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#ga3a10548dfc0948bb2e29ac416dc8a901">noise_cipherstate_set_nonce</a> (<a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, uint64_t nonce)</td></tr>
<tr class="memdesc:ga3a10548dfc0948bb2e29ac416dc8a901"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the nonce value for this cipherstate object.  <a href="#ga3a10548dfc0948bb2e29ac416dc8a901">More...</a><br/></td></tr>
<tr class="separator:ga3a10548dfc0948bb2e29ac416dc8a901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1670e8a21551140558f8ea7ac686589"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cipherstate.html#gac1670e8a21551140558f8ea7ac686589">noise_cipherstate_split</a> (const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *state, const uint8_t *key, size_t key_len, <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **new_state)</td></tr>
<tr class="memdesc:gac1670e8a21551140558f8ea7ac686589"><td class="mdescLeft">&#160;</td><td class="mdescRight">Splits a new CipherState object out of an existing object.  <a href="#gac1670e8a21551140558f8ea7ac686589">More...</a><br/></td></tr>
<tr class="separator:gac1670e8a21551140558f8ea7ac686589"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>CipherState objects are used to encrypt or decrypt data during a session. Once the handshake has completed, <a class="el" href="group__symmetricstate.html#gadf7cef60a64aef703add9b093c3b6c63" title="Splits the transport encryption CipherState objects out of this SymmetricState object. ">noise_symmetricstate_split()</a> will create two CipherState objects for encrypting packets sent to the other party, and decrypting packets received from the other party. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gaed43ed8af5dd6f1a8ce2246c5bb00dc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opaque object that represents a CipherState. </p>

<p>Definition at line <a class="el" href="cipherstate_8h_source.html#l00033">33</a> of file <a class="el" href="cipherstate_8h_source.html">cipherstate.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga147f818d2466e7c3a1cbab91ca631bba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_decrypt_with_ad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>in_data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>out_data_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a block of data with this CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">ad</td><td>Points to the associated data, which can be NULL only if <em>ad_len</em> is zero. </td></tr>
    <tr><td class="paramname">ad_len</td><td>The length of the associated data in bytes. </td></tr>
    <tr><td class="paramname">data</td><td>On entry, contains the ciphertext plus MAC. On exit, contains the plaintext. </td></tr>
    <tr><td class="paramname">in_data_len</td><td>The number of bytes in <em>data</em>, including both the ciphertext and the MAC. </td></tr>
    <tr><td class="paramname">out_data_len</td><td>Set to the number of plaintext bytes in <em>data</em> on exit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if the parameters are invalid. </dd>
<dd>
NOISE_ERROR_MAC_FAILURE if the MAC check failed. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if the nonce previously overflowed. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>in_data_len</em> is larger than 65535 bytes or too small to contain the MAC value.</dd></dl>
<p>The ciphertext is decrypted in-place with the plaintext also written to <em>data</em>. In other words, it is assumed that the ciphertext plus MAC is in an input buffer ready to be processed once the MAC has been checked and the ciphertext has been decrypted.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gaba9d99ad1068e4aa1a6b49e1ef83827e" title="Encrypts a block of data with this CipherState object. ">noise_cipherstate_encrypt_with_ad()</a>, <a class="el" href="group__cipherstate.html#gae96037b3451f22ac86e51cfc177a06ad" title="Gets the length of packet MAC values for a CipherState object. ">noise_cipherstate_get_mac_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00349">349</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaba9d99ad1068e4aa1a6b49e1ef83827e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_encrypt_with_ad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>in_data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>out_data_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts a block of data with this CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">ad</td><td>Points to the associated data, which can be NULL only if <em>ad_len</em> is zero. </td></tr>
    <tr><td class="paramname">ad_len</td><td>The length of the associated data in bytes. </td></tr>
    <tr><td class="paramname">data</td><td>On entry, contains the plaintext. On exit, contains the ciphertext plus the MAC. </td></tr>
    <tr><td class="paramname">in_data_len</td><td>The number of bytes of plaintext in <em>data</em>. </td></tr>
    <tr><td class="paramname">out_data_len</td><td>Set to the number of bytes of ciphertext plus MAC in <em>data</em> on exit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if the parameters are invalid. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if the nonce previously overflowed. </dd>
<dd>
or NOISE_ERROR_INVALID_LENGTH if <em>in_data_len</em> is too large to contain the ciphertext plus MAC and still remain within 65535 bytes.</dd></dl>
<p>The plaintext is encrypted in-place with the ciphertext also written to <em>data</em>. There must be enough room on the end of <em>data</em> to hold the extra MAC value that will be appended. In other words, it is assumed that the plaintext is in an output buffer ready to be transmitted once the data has been encrypted and the final packet length (<em>out_data_len</em>) has been determined.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga147f818d2466e7c3a1cbab91ca631bba" title="Decrypts a block of data with this CipherState object. ">noise_cipherstate_decrypt_with_ad()</a>, <a class="el" href="group__cipherstate.html#gae96037b3451f22ac86e51cfc177a06ad" title="Gets the length of packet MAC values for a CipherState object. ">noise_cipherstate_get_mac_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00278">278</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga407f8ce7855758296400eff1eb6c065a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a CipherState object after destroying all sensitive material. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object to free.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga83cc7e0f12b78373523cdb054cad2a0e" title="Creates a new CipherState object by its algorithm identifier. ">noise_cipherstate_new_by_id()</a>, <a class="el" href="group__cipherstate.html#gad028a9c95917d2e5f148c317bfaa9696" title="Creates a new CipherState object by its algorithm name. ">noise_cipherstate_new_by_name()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00142">142</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga5f0813b96f29325f5e1937ab80012c1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_get_cipher_id </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the algorithm identifier for a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The algorithm identifier, or NOISE_CIPHER_NONE if <em>state</em> is NULL. </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00170">170</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaf2e1035f4d0b85154176d9a3042eee81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t noise_cipherstate_get_key_length </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the length of the encryption key for a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the key in bytes, or 0 if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gae96037b3451f22ac86e51cfc177a06ad" title="Gets the length of packet MAC values for a CipherState object. ">noise_cipherstate_get_mac_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00184">184</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gae96037b3451f22ac86e51cfc177a06ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t noise_cipherstate_get_mac_length </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the length of packet MAC values for a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the MAC in bytes, or 0 if <em>state</em> is NULL.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gaf2e1035f4d0b85154176d9a3042eee81" title="Gets the length of the encryption key for a CipherState object. ">noise_cipherstate_get_key_length()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00198">198</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga7c8497c3f9682d6ac5b6cbce58a4a9e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_has_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the key has been set on a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 if the key has been set, or 0 if the key has not been set (or <em>state</em> is NULL).</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gac10e4b2b02a43c1e1e23253420eea1d0" title="Initializes the key on a CipherState object. ">noise_cipherstate_init_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00244">244</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gac10e4b2b02a43c1e1e23253420eea1d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_init_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the key on a CipherState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">key</td><td>Points to the key. </td></tr>
    <tr><td class="paramname">key_len</td><td>The length of the key in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>key</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>key_len</em> is the wrong length for this cipher.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gaf2e1035f4d0b85154176d9a3042eee81" title="Gets the length of the encryption key for a CipherState object. ">noise_cipherstate_get_key_length()</a>, <a class="el" href="group__cipherstate.html#ga7c8497c3f9682d6ac5b6cbce58a4a9e3" title="Determine if the key has been set on a CipherState object. ">noise_cipherstate_has_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00218">218</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga83cc7e0f12b78373523cdb054cad2a0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_new_by_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new CipherState object by its algorithm identifier. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Points to the variable where to store the pointer to the new CipherState object. </td></tr>
    <tr><td class="paramname">id</td><td>The algorithm identifier; NOISE_CIPHER_CHACHAPOLY, NOISE_CIPHER_AESGCM, etc.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL. </dd>
<dd>
NOISE_ERROR_UNKNOWN_ID if <em>id</em> is unknown. </dd>
<dd>
or NOISE_ERROR_NO_MEMORY if there is insufficient memory to allocate the new CipherState object.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga407f8ce7855758296400eff1eb6c065a" title="Frees a CipherState object after destroying all sensitive material. ">noise_cipherstate_free()</a>, <a class="el" href="group__cipherstate.html#gad028a9c95917d2e5f148c317bfaa9696" title="Creates a new CipherState object by its algorithm name. ">noise_cipherstate_new_by_name()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00067">67</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gad028a9c95917d2e5f148c317bfaa9696"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_new_by_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new CipherState object by its algorithm name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Points to the variable where to store the pointer to the new CipherState object. </td></tr>
    <tr><td class="paramname">name</td><td>The name of the cipher algorithm; e.g. "ChaChaPoly". This string must be NUL-terminated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>name</em> is NULL. </dd>
<dd>
NOISE_ERROR_UNKNOWN_NAME if <em>name</em> is unknown. </dd>
<dd>
NOISE_ERROR_NO_MEMORY if there is insufficient memory to allocate the new CipherState object.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga407f8ce7855758296400eff1eb6c065a" title="Frees a CipherState object after destroying all sensitive material. ">noise_cipherstate_free()</a>, <a class="el" href="group__cipherstate.html#ga83cc7e0f12b78373523cdb054cad2a0e" title="Creates a new CipherState object by its algorithm identifier. ">noise_cipherstate_new_by_id()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00112">112</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gacf9f934dd976784f58aef4088a4f7b7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_pad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>orig_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>padded_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>padding_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds padding bytes to the end of a message payload. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">payload</td><td>Points to the original message payload to be padded, which must be large enough to hold the maximum of <em>orig_len</em> or <em>padded_len</em>. </td></tr>
    <tr><td class="paramname">orig_len</td><td>The original length of the payload before padding. </td></tr>
    <tr><td class="paramname">padded_len</td><td>The new length of the payload, including the original data and padding. </td></tr>
    <tr><td class="paramname">padding_mode</td><td>The padding mode to use, NOISE_PADDING_ZERO or NOISE_PADDING_RANDOM. If the padding mode is unknown, then NOISE_PADDING_RANDOM will be used instead.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>payload</em> is NULL. </dd>
<dd>
NOISE_ERROR_NO_MEMORY if this is the first time this function has been used to generate random padding and there is insufficient memory to allocate the state for the random number generator. Will not occur if the <em>padding_mode</em> is NOISE_PADDING_ZERO.</dd></dl>
<p>This function is intended for padding message payloads prior to them being encrypted with <a class="el" href="group__handshakestate.html#ga305a81df454bd2cd2b039061e79849a8" title="Writes a message payload using a HandshakeState. ">noise_handshakestate_write_message()</a> or <a class="el" href="group__cipherstate.html#gaba9d99ad1068e4aa1a6b49e1ef83827e" title="Encrypts a block of data with this CipherState object. ">noise_cipherstate_encrypt_with_ad()</a>. If the <em>padding_mode</em> is NOISE_PADDING_RANDOM, then the random bytes are generated using <a class="el" href="group__cipherstate.html#ga516ad81b9355cba6ab08c18fa3cf7479" title="Generates random bytes for use by the application. ">noise_cipherstate_rand_bytes()</a>.</p>
<p>The number of padding bytes added will be <em>padded_len</em> - <em>orig_len</em>. If <em>padded_len</em> is less than or equal to <em>orig_len</em>, then no padding bytes will be added. Essentially, this function pads the payload to a minimum length. Larger payloads are transmitted as-is.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#ga516ad81b9355cba6ab08c18fa3cf7479" title="Generates random bytes for use by the application. ">noise_cipherstate_rand_bytes()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00652">652</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga516ad81b9355cba6ab08c18fa3cf7479"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_rand_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>force_reseed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates random bytes for use by the application. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer to fill with random bytes. </td></tr>
    <tr><td class="paramname">len</td><td>The number of random bytes to generate. </td></tr>
    <tr><td class="paramname">force_reseed</td><td>Non-zero to force the random number generator to reseed entropy from the operating system, zero to let this function decide itself when to reseed (zero is recommended).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> or <em>buffer</em> is NULL. </dd>
<dd>
NOISE_ERROR_NO_MEMORY if this is the first time this function has been called and there is insufficient memory to allocate the state for the random number generator.</dd></dl>
<p>This function is provided as a convenience for applications that need to generate extra random data during the course of a higher-level protocol that runs over the Noise protocol.</p>
<p>If the application wishes to pad message payloads with random data, then the <a class="el" href="group__cipherstate.html#gacf9f934dd976784f58aef4088a4f7b7d" title="Adds padding bytes to the end of a message payload. ">noise_cipherstate_pad()</a> function may be a better option.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gacf9f934dd976784f58aef4088a4f7b7d" title="Adds padding bytes to the end of a message payload. ">noise_cipherstate_pad()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00550">550</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga3a10548dfc0948bb2e29ac416dc8a901"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_set_nonce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>nonce</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the nonce value for this cipherstate object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The CipherState object. </td></tr>
    <tr><td class="paramname">nonce</td><td>The new nonce value to set. This must be greater than or equal to the current nonce value in the state.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if <em>state</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_STATE if the key has not been set yet. </dd>
<dd>
NOISE_ERROR_INVALID_NONCE if <em>nonce</em> is smaller than the current value.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function is intended for testing purposes only. It is dangerous to set the nonce back to a previously-used value so this function will actively prevent that from happening.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__cipherstate.html#gac10e4b2b02a43c1e1e23253420eea1d0" title="Initializes the key on a CipherState object. ">noise_cipherstate_init_key()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00459">459</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
<a class="anchor" id="gac1670e8a21551140558f8ea7ac686589"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int noise_cipherstate_split </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cipherstate.html#gaed43ed8af5dd6f1a8ce2246c5bb00dc1">NoiseCipherState</a> **&#160;</td>
          <td class="paramname"><em>new_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Splits a new CipherState object out of an existing object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The existing CipherState object. </td></tr>
    <tr><td class="paramname">key</td><td>Points to the key to set on the new CipherState object. </td></tr>
    <tr><td class="paramname">key_len</td><td>The length of the key in bytes. </td></tr>
    <tr><td class="paramname">new_state</td><td>Points to a variable that should be set to a pointer to the new CipherState object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NOISE_ERROR_NONE on success. </dd>
<dd>
NOISE_ERROR_INVALID_PARAM if one of <em>state</em>, <em>key</em>, or <em>new_state</em> is NULL. </dd>
<dd>
NOISE_ERROR_INVALID_LENGTH if <em>key_len</em> is incorrect for the cipher. </dd>
<dd>
or NOISE_ERROR_NO_MEMORY if the system is out of memory.</dd></dl>
<p>This function is intended to help implement <a class="el" href="group__symmetricstate.html#gadf7cef60a64aef703add9b093c3b6c63" title="Splits the transport encryption CipherState objects out of this SymmetricState object. ">noise_symmetricstate_split()</a>. It clones the existing object, creating a new object with the same algorithm identifier but a new key.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__symmetricstate.html#gadf7cef60a64aef703add9b093c3b6c63" title="Splits the transport encryption CipherState objects out of this SymmetricState object. ">noise_symmetricstate_split()</a> </dd></dl>

<p>Definition at line <a class="el" href="cipherstate_8c_source.html#l00416">416</a> of file <a class="el" href="cipherstate_8c_source.html">cipherstate.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 19 2016 19:03:04 for Noise-C by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
